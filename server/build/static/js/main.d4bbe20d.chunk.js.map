{"version":3,"sources":["react_components/ServerError.js","react_components/ServerRequest.js","react_components/StartChat.js","react_components/MUI/Message.js","react_components/MUI/ChatCard.js","react_components/MUI/Menu.js","react_components/MUI/Header.js","react_components/Chats.js","react_components/MUI/ContactCard.js","react_components/Contacts.js","react_components/Modals/LogOut.js","react_components/Modals/AddContact.js","react_components/SignIn.js","react_components/SignUp.js","react_components/SignInError.js","react_components/SignUpError.js","react_components/Modals/AddContactSuccess.js","react_components/Modals/AddContactError.js","react_components/Modals/AddContactWait.js","react_components/MUI/NewChatMenu.js","react_components/MUI/NewChatCard.js","react_components/NewChat.js","react_components/Modals/CreateGroupChat.js","react_components/Modals/UploadPhoto.js","react_components/Modals/CreateGroupChatWait.js","react_components/Modals/ServerWait.js","services/renderService.js","requests/signInRequest.js","requests/signUpRequest.js","requests/heartbeat.js","requests/addContactRequest.js","requests/changePhotoRequest.js","requests/sendMessageRequest.js","requests/updateRequest.js","requests/createPrivateChatRequest.js","requests/createGroupChatRequest.js","requests/subscribe.js","services/networkService.js","machines/loginMachine.js","machines/chatMachine.js","App.js","index.js"],"names":["ServerError","ServerRequest","Backdrop","style","zIndex","open","CircularProgress","color","StartChat","Message","data","message","action","Card","sx","width","margin","alignSelf","name","myName","CardContent","Typography","gutterBottom","variant","component","ChatCard","chatName","chatId","messages","photo","activeChat","lastMessage","length","slice","Box","ListItemButton","backgroundColor","alignItems","onClick","type","ListItemAvatar","Avatar","alt","src","ListItemText","primary","secondary","display","Divider","ChatMenu","React","anchorEl","setAnchorEl","Boolean","handleClose","IconButton","size","edge","mr","event","currentTarget","Menu","id","onClose","MenuListProps","MenuItem","header","Grid","item","xs","height","flexGrow","AppBar","position","Toolbar","cursor","Button","ChatActive","chats","find","chat","undefined","map","m","getMessages","x","document","getElementById","value","ch","typingMessage","container","border","Header","List","maxWidth","bgcolor","overflow","justifyContent","Paper","flexDirection","TextField","disabled","label","multiline","rows","focused","onChange","e","target","trim","ContactCard","contact","ChoosingContact","contacts","top","left","transform","boxShadow","p","LogOut","Modal","AddContact","Dialog","DialogTitle","DialogContent","DialogContentText","autoFocus","fullWidth","DialogActions","Copyright","align","useStyles","makeStyles","theme","paper","marginTop","spacing","avatar","palette","main","form","submit","SignIn","classes","y","password","Container","CssBaseline","className","noValidate","required","autoComplete","filled","Link","href","mt","SignUp","SignInError","SignUpError","answer","AddContactSuccess","AddContactError","AddContactWait","NewChatMenu","NewChatCard","NewChat","activeContact","CreateGroupChat","checked","setChecked","setChatName","btnDisabled","setBtnDisabled","maxHeight","dense","cont","labelId","ListItem","secondaryAction","Checkbox","currentIndex","indexOf","newChecked","push","splice","inputProps","disablePadding","UploadPhoto","useState","setPhoto","htmlFor","preview","file","files","reader","FileReader","addEventListener","result","readAsDataURL","upload","CreateGroupChatWait","ServerWait","renderService","callback","onEvent","ReactDOM","render","Chats","Contacts","console","log","signInRequest","a","fetch","headers","Accept","method","body","JSON","stringify","response","json","token","key","subsKey","signUpRequest","publicKey","heartbeat","addContactRequest","addingContact","changePhotoRequest","sendMessageRequest","updateRequest","createPrivateChatRequest","insertedId","createGroupChatRequest","groupChatData","subscribe","getReader","read","parse","String","fromCharCode","apply","networkService","loginMachine","createMachine","initial","context","entry","assign","renderServiceRef","spawn","networkServiceRef","states","signIn","on","SIGNUP_CLICK","SIGNIN_CLICK","notFilled","send","ctx","to","FILLNAME","actions","FILLPASSWORD","CHANGESTATE","cond","SUCCESS","c","ERROR","NETWORKERROR","signUp","CANCEL_CLICK","SUBMIT_CLICK","signInError","OK","signUpError","finish","sendParent","serverError","cxt","generateRSAKey","RSAkey","cryptico","getPublicKey","publicKeyString","fillName","fillPassword","contextlog","resetName","resetPassword","renderSignInPage","renderFinisWithError","chatMachine","UPDATE","DATARECIEVED","HEARTBEAT","loading","SUBSCRIBED","ADDCONTACT","CREATEGROUPCHAT","LOGOUT_CLICK","CHANGEAVATAR","choosingChat","CHANGEACTIVE","SWITCHTOCONTACTS","TYPING","RENDER","SENDMESSAGE","CLEARINPUT","exit","choosingContact","SWITCHTOCHATS","STARTCHAT","some","newChat","idle","CANCEL","STARTNEWCHAT","creatingNewChat","sendingMessage","errorState","hist","addContactState","SUBMIT","waitingForServer","sucessState","TRYAGAIN","uploadPhoto","UPDATEPHOTO","DELETEPHOTO","logOut","YES","NO","createGroupChat","SEND","SUCCSESS","subscribeToServerEvents","sendHeartBeat","setContacts","setChats","renderChat","resetContact","resetMessage","getData","sendMessage","createChat","renderLoadingPage","renderNewChat","renderAddContact","renderCreateGroupChat","updateContacts","updateChats","decrypt","plaintext","updatePhoto","updateActiveChatId","renderContacts","clearActiveContact","clearActiveChat","clearMessage","renderSerwerWait","renderLogOut","appMachine","login","invoke","FINISH","interpret","start","App"],"mappings":"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","file":"static/js/main.d4bbe20d.chunk.js","sourcesContent":["const ServerError = () => {\r\n  return (\r\n    <div>\r\n      <h1>Server error. Try again Later</h1>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ServerError\r\n","import React from \"react\"\r\nimport Backdrop from \"@material-ui/core/Backdrop\"\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\"\r\n\r\nconst ServerRequest = () => {\r\n  return (\r\n    <Backdrop style={{ zIndex: 1 }} open={true}>\r\n      <CircularProgress color=\"inherit\" />\r\n    </Backdrop>\r\n  )\r\n}\r\n\r\nexport default ServerRequest\r\n","import React from \"react\"\r\n\r\nconst StartChat = () => (\r\n  <div>\r\n    <div>\r\n      <h1>START CHAT</h1>\r\n    </div>\r\n  </div>\r\n)\r\n\r\nexport default StartChat\r\n","import * as React from \"react\"\r\nimport Card from \"@mui/material/Card\"\r\nimport CardContent from \"@mui/material/CardContent\"\r\nimport Typography from \"@mui/material/Typography\"\r\n\r\nconst Message = ({ data, action, message }) => {\r\n  return (\r\n    <Card sx={{ width: \"50%\", margin: \"10px\", alignSelf: message.name === data.myName ? \"flex-end\" : \"flex-start\" }}>\r\n      <CardContent>\r\n        <Typography gutterBottom variant=\"body2\" component=\"div\">\r\n          {\"name: \" + message.name}\r\n        </Typography>\r\n        <Typography variant=\"body2\" color=\"text.secondary\">\r\n          {message.message}\r\n        </Typography>\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}\r\n\r\nexport default Message\r\n","import * as React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport Typography from \"@mui/material/Typography\"\r\nimport ListItemButton from \"@mui/material/ListItemButton\"\r\nimport ListItemText from \"@mui/material/ListItemText\"\r\nimport Divider from \"@mui/material/Divider\"\r\nimport ListItemAvatar from \"@mui/material/ListItemAvatar\"\r\nimport Avatar from \"@mui/material/Avatar\"\r\n\r\nconst ChatCard = ({ data, action }) => {\r\n  const { chatName, chatId, messages, photo, activeChat } = data\r\n  let lastMessage = \"\"\r\n  if (messages.length > 0) {\r\n    const { name, message } = messages.slice(-1)[0]\r\n    lastMessage = `${name}: ${message}`\r\n  }\r\n  return (\r\n    <Box>\r\n      <ListItemButton sx={{ backgroundColor: chatId === activeChat ? \"rgba(0, 0, 0, 0.05)\" : \"\" }} alignItems=\"flex-start\" onClick={() => action({ type: \"CHANGEACTIVE\", chatId })}>\r\n        <ListItemAvatar>\r\n          <Avatar alt={chatName} src={photo} />\r\n        </ListItemAvatar>\r\n        <ListItemText\r\n          primary={chatName}\r\n          secondary={\r\n            <React.Fragment>\r\n              <Typography sx={{ display: \"inline\" }} component=\"span\" variant=\"body2\" color=\"text.primary\">\r\n                {lastMessage}\r\n              </Typography>\r\n            </React.Fragment>\r\n          }\r\n        />\r\n      </ListItemButton>\r\n      <Divider variant=\"inset\" component=\"li\" />\r\n    </Box>\r\n  )\r\n}\r\n\r\nexport default ChatCard\r\n","import * as React from \"react\"\r\nimport Menu from \"@mui/material/Menu\"\r\nimport MenuItem from \"@mui/material/MenuItem\"\r\nimport IconButton from \"@mui/material/IconButton\"\r\nimport MenuIcon from \"@mui/icons-material/Menu\"\r\n\r\nconst ChatMenu = ({ action }) => {\r\n  const [anchorEl, setAnchorEl] = React.useState(null)\r\n  const open = Boolean(anchorEl)\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget)\r\n  }\r\n  const handleClose = () => {\r\n    setAnchorEl(null)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <IconButton size=\"large\" edge=\"start\" color=\"inherit\" aria-label=\"menu\" sx={{ mr: 2 }} onClick={handleClick}>\r\n        <MenuIcon />\r\n      </IconButton>\r\n      <Menu\r\n        id=\"basic-menu\"\r\n        anchorEl={anchorEl}\r\n        open={open}\r\n        onClose={handleClose}\r\n        MenuListProps={{\r\n          \"aria-labelledby\": \"basic-button\",\r\n        }}\r\n      >\r\n        <MenuItem onClick={() => action(\"SWITCHTOCHATS\")}>Chats</MenuItem>\r\n        <MenuItem onClick={() => action(\"SWITCHTOCONTACTS\")}>Contacts</MenuItem>\r\n        <MenuItem\r\n          onClick={() => {\r\n            handleClose()\r\n            action(\"ADDCONTACT\")\r\n          }}\r\n        >\r\n          Add contact\r\n        </MenuItem>\r\n        <MenuItem\r\n          onClick={() => {\r\n            handleClose()\r\n            action(\"CREATEGROUPCHAT\")\r\n          }}\r\n        >\r\n          Create group chat\r\n        </MenuItem>\r\n      </Menu>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ChatMenu\r\n","import * as React from \"react\"\r\nimport AppBar from \"@mui/material/AppBar\"\r\nimport Box from \"@mui/material/Box\"\r\nimport Toolbar from \"@mui/material/Toolbar\"\r\nimport Typography from \"@mui/material/Typography\"\r\nimport Grid from \"@mui/material/Grid\"\r\nimport ListItemAvatar from \"@mui/material/ListItemAvatar\"\r\nimport Avatar from \"@mui/material/Avatar\"\r\nimport Button from \"@mui/material/Button\"\r\nimport Menu from \"./Menu\"\r\n\r\nconst header = ({ data, action }) => (\r\n  <Grid item xs={12} style={{ height: \"10%\" }}>\r\n    <Box sx={{ flexGrow: 1 }}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <Menu action={action}></Menu>\r\n          <ListItemAvatar>\r\n            <Avatar style={{ cursor: \"pointer\" }} onClick={() => action(\"CHANGEAVATAR\")} src={data.photo} />\r\n          </ListItemAvatar>\r\n          <Typography variant=\"h6\" component=\"div\" sx={{ flexGrow: 1 }}>\r\n            {data.myName}\r\n          </Typography>\r\n          <Button color=\"inherit\" onClick={() => action(\"LOGOUT_CLICK\")}>\r\n            logout\r\n          </Button>\r\n        </Toolbar>\r\n      </AppBar>\r\n    </Box>\r\n  </Grid>\r\n)\r\n\r\nexport default header\r\n","import React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport List from \"@mui/material/List\"\r\nimport Grid from \"@mui/material/Grid\"\r\nimport Paper from \"@mui/material/Paper\"\r\nimport TextField from \"@mui/material/TextField\"\r\nimport Button from \"@mui/material/Button\"\r\nimport Message from \"./MUI/Message\"\r\nimport ChatCard from \"./MUI/ChatCard\"\r\nimport Header from \"./MUI/Header\"\r\n\r\nconst getMessages = (data) => {\r\n  if (!data.activeChat) return \"\"\r\n  const chatId = data.chats.find((chat) => chat.chatId === data.activeChat).chatId\r\n  if (chatId === undefined) return \"\"\r\n  const arr = data.chats.find((chat) => chat.chatId === chatId).messages.map((m) => <Message data={data} message={m}></Message>)\r\n  return arr\r\n}\r\n\r\nconst ChatActive = ({ action, data }) => {\r\n  const messages = getMessages(data)\r\n  const x = document.getElementById(\"input-message\")\r\n  if (x) x.value = (data.chats.find((ch) => ch.chatId === data.activeChat) || {}).typingMessage || \"\"\r\n  return (\r\n    <Grid container sx={{ height: \"100vh\", border: \"solid blue 0px\" }}>\r\n      <Header action={action} data={data}></Header>\r\n      <Grid item xs={3} style={{ height: \"90%\", border: \"0px solid red\" }}>\r\n        <List sx={{ width: \"100%\", maxWidth: 360, bgcolor: \"background.paper\" }} style={{ height: \"92%\", overflow: \"auto\" }}>\r\n          {data.chats.map((chat) => (\r\n            <ChatCard data={{ ...chat, activeChat: data.activeChat }} action={action}></ChatCard>\r\n          ))}\r\n        </List>\r\n      </Grid>\r\n      <Grid container xs={9} justifyContent=\"center\" style={{ height: \"90%\", border: \"0px solid red\" }}>\r\n        <Grid item xs={12} style={{ height: \"80%\", border: \"solid 0px red\" }}>\r\n          <Paper sx={{ height: \"98%\", margin: \"0 1% 0% 1%\", border: \"solid 0px blue\" }}>\r\n            <List sx={{ height: \"97%\" }} style={{ overflow: \"auto\", display: \"flex\", flexDirection: \"column-reverse\" }}>\r\n              <Box style={{ display: \"flex\", flexDirection: \"column\", border: \"0px solid red\" }}>{messages}</Box>\r\n            </List>\r\n          </Paper>\r\n        </Grid>\r\n        <Grid item xs={12} style={{ height: \"20%\", border: \"solid 0px red\" }}>\r\n          <Box sx={{ height: \"95%\", margin: \"0 1% 0% 1%\", border: \"solid 0px blue\", display: \"flex\", justifyContent: \"space-between\" }}>\r\n            <TextField\r\n              id=\"input-message\"\r\n              disabled={data.activeChat === \"\"}\r\n              label=\"Insert your message\"\r\n              multiline\r\n              rows={4}\r\n              focused\r\n              style={{ width: \"90%\" }}\r\n              onChange={(e) => {\r\n                if (e.target.value.trim().length <= 1) action(\"RENDER\")\r\n                action({ type: \"TYPING\", data: e.target.value })\r\n              }}\r\n            />\r\n            <Button\r\n              id=\"send-btn\"\r\n              disabled={x ? !x.value.trim() : true}\r\n              variant=\"contained\"\r\n              style={{ height: \"93%\" }}\r\n              onClick={() => {\r\n                action(\"SENDMESSAGE\")\r\n                action(\"CLEARINPUT\")\r\n              }}\r\n            >\r\n              SEND\r\n            </Button>\r\n          </Box>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  )\r\n}\r\n\r\nexport default ChatActive\r\n","import * as React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport ListItemButton from \"@mui/material/ListItemButton\"\r\nimport ListItemText from \"@mui/material/ListItemText\"\r\nimport Divider from \"@mui/material/Divider\"\r\nimport ListItemAvatar from \"@mui/material/ListItemAvatar\"\r\nimport Avatar from \"@mui/material/Avatar\"\r\n\r\nconst ContactCard = ({ contact, action }) => {\r\n  return (\r\n    <Box>\r\n      <ListItemButton\r\n        onClick={() => {\r\n          action({ type: \"CHANGEACTIVE\", contact: contact.name })\r\n          action(\"STARTCHAT\")\r\n        }}\r\n        alignItems=\"flex-start\"\r\n      >\r\n        <ListItemAvatar>\r\n          <Avatar alt={contact.name} src={contact.photo} />\r\n        </ListItemAvatar>\r\n        <ListItemText primary={contact.name} />\r\n      </ListItemButton>\r\n      <Divider variant=\"inset\" component=\"li\" />\r\n    </Box>\r\n  )\r\n}\r\n\r\nexport default ContactCard\r\n","import React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport List from \"@mui/material/List\"\r\nimport Grid from \"@mui/material/Grid\"\r\nimport Paper from \"@mui/material/Paper\"\r\nimport TextField from \"@mui/material/TextField\"\r\nimport Button from \"@mui/material/Button\"\r\nimport ContactCard from \"./MUI/ContactCard\"\r\nimport Header from \"./MUI/Header.js\"\r\n\r\nconst ChoosingContact = ({ action, data }) => {\r\n  return (\r\n    <Grid container sx={{ height: \"100vh\", border: \"solid blue 0px\" }}>\r\n      <Header action={action} data={data}></Header>\r\n      <Grid item xs={3} style={{ height: \"90%\", border: \"0px solid red\" }}>\r\n        <List sx={{ width: \"100%\", maxWidth: 360, bgcolor: \"background.paper\" }} style={{ height: \"92%\", overflow: \"auto\" }}>\r\n          {data.contacts.map((contact) => (\r\n            <ContactCard contact={contact} action={action}></ContactCard>\r\n          ))}\r\n        </List>\r\n      </Grid>\r\n      <Grid container xs={9} justifyContent=\"center\" style={{ height: \"90%\", border: \"0px solid red\" }}>\r\n        <Grid item xs={12} style={{ height: \"80%\", border: \"solid 0px red\" }}>\r\n          <Paper sx={{ height: \"98%\", margin: \"0 1% 0% 1%\", border: \"solid 0px blue\" }}></Paper>\r\n        </Grid>\r\n        <Grid item xs={12} style={{ height: \"20%\", border: \"solid 0px red\" }}>\r\n          <Box sx={{ height: \"95%\", margin: \"0 1% 0% 1%\", border: \"solid 0px blue\", display: \"flex\", justifyContent: \"space-between\" }}>\r\n            <TextField disabled={true} label=\"Insert your message\" multiline rows={4} focused style={{ width: \"90%\" }} />\r\n            <Button disabled={true} variant=\"contained\" style={{ height: \"93%\" }}>\r\n              SEND\r\n            </Button>\r\n          </Box>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  )\r\n}\r\n\r\nexport default ChoosingContact\r\n","import * as React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport Button from \"@mui/material/Button\"\r\nimport Typography from \"@mui/material/Typography\"\r\nimport Modal from \"@mui/material/Modal\"\r\n\r\nconst style = {\r\n  position: \"absolute\",\r\n  top: \"50%\",\r\n  left: \"50%\",\r\n  transform: \"translate(-50%, -50%)\",\r\n  width: 400,\r\n  bgcolor: \"background.paper\",\r\n  border: \"2px solid #000\",\r\n  boxShadow: 24,\r\n  p: 4,\r\n}\r\n\r\nconst LogOut = ({ action }) => (\r\n  <Modal open={true} aria-labelledby=\"modal-modal-title\" aria-describedby=\"modal-modal-description\">\r\n    <Box sx={style}>\r\n      <Typography id=\"modal-modal-title\" variant=\"h6\" component=\"h2\">\r\n        Are you sure you want to exit?\r\n      </Typography>\r\n      <Button onClick={() => action(\"YES\")}>YES</Button>\r\n      <Button onClick={() => action(\"NO\")}>NO</Button>\r\n    </Box>\r\n  </Modal>\r\n)\r\n\r\nexport default LogOut\r\n","import React from \"react\"\r\nimport Button from \"@mui/material/Button\"\r\nimport TextField from \"@mui/material/TextField\"\r\nimport Dialog from \"@mui/material/Dialog\"\r\nimport DialogActions from \"@mui/material/DialogActions\"\r\nimport DialogContent from \"@mui/material/DialogContent\"\r\nimport DialogContentText from \"@mui/material/DialogContentText\"\r\nimport DialogTitle from \"@mui/material/DialogTitle\"\r\n\r\nconst AddContact = ({ data, action }) => {\r\n  return (\r\n    <div>\r\n      <Dialog open={true}>\r\n        <DialogTitle>Add contact</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>Enter email to add</DialogContentText>\r\n          <TextField autoFocus margin=\"dense\" id=\"name\" label=\"Email Address\" type=\"email\" fullWidth variant=\"standard\" onChange={(e) => action({ type: \"TYPING\", data: e.target.value })} />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => action(\"SUBMIT\")}>Search</Button>\r\n          <Button onClick={() => action(\"CANCEL\")}>Cancel</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default AddContact\r\n","import React from \"react\"\r\nimport Avatar from \"@material-ui/core/Avatar\"\r\nimport Button from \"@material-ui/core/Button\"\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\"\r\nimport TextField from \"@material-ui/core/TextField\"\r\nimport Link from \"@material-ui/core/Link\"\r\nimport Grid from \"@material-ui/core/Grid\"\r\nimport Box from \"@material-ui/core/Box\"\r\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\"\r\nimport Typography from \"@material-ui/core/Typography\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport Container from \"@material-ui/core/Container\"\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {\"Developed by asltyn@rambler.ru\"}\r\n    </Typography>\r\n  )\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\",\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  form: {\r\n    width: \"100%\",\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n}))\r\n\r\nconst SignIn = ({ action, data }) => {\r\n  const classes = useStyles()\r\n  const x = document.getElementById(\"name\")\r\n  if (x) x.value = data.name\r\n  const y = document.getElementById(\"password\")\r\n  if (y) y.value = data.password\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          chat\r\n        </Typography>\r\n        <form className={classes.form} noValidate>\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"name\"\r\n            label=\"Name\"\r\n            name=\"name\"\r\n            autoComplete=\"name\"\r\n            onChange={(e) => action({ type: \"FILLNAME\", data: e.target.value })}\r\n          />\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            name=\"password\"\r\n            label=\"Password\"\r\n            type=\"password\"\r\n            id=\"password\"\r\n            onChange={(e) => action({ type: \"FILLPASSWORD\", data: e.target.value })}\r\n            autoComplete=\"current-password\"\r\n          />\r\n          <Button\r\n            disabled={!data.filled}\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            className={classes.submit}\r\n            onClick={() => {\r\n              action({ type: \"SIGNIN_CLICK\" })\r\n            }}\r\n          >\r\n            Sign In\r\n          </Button>\r\n          <Grid container>\r\n            <Grid item xs>\r\n              <Link href=\"#\" variant=\"body2\" onClick={() => action(\"RECOVERY_CLICK\")}>\r\n                Forgot password?\r\n              </Link>\r\n            </Grid>\r\n            <Grid item>\r\n              <Link href=\"#\" variant=\"body2\" onClick={() => action(\"SIGNUP_CLICK\")}>\r\n                {\"Don't have an account? Sign Up\"}\r\n              </Link>\r\n            </Grid>\r\n          </Grid>\r\n        </form>\r\n      </div>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default SignIn\r\n","import React from \"react\"\r\nimport Avatar from \"@material-ui/core/Avatar\"\r\nimport Button from \"@material-ui/core/Button\"\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\"\r\nimport TextField from \"@material-ui/core/TextField\"\r\nimport Box from \"@material-ui/core/Box\"\r\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\"\r\nimport Typography from \"@material-ui/core/Typography\"\r\nimport { makeStyles } from \"@material-ui/core/styles\"\r\nimport Container from \"@material-ui/core/Container\"\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {\"Developed by asltyn@rambler.ru\"}\r\n    </Typography>\r\n  )\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    alignItems: \"center\",\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  form: {\r\n    width: \"100%\",\r\n    marginTop: theme.spacing(1),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n}))\r\n\r\nconst SignUp = ({ action, data }) => {\r\n  const classes = useStyles()\r\n  const x = document.getElementById(\"name\")\r\n  if (x) x.value = data.name\r\n  const y = document.getElementById(\"password\")\r\n  if (y) y.value = data.password\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <CssBaseline />\r\n      <div className={classes.paper}>\r\n        <Avatar className={classes.avatar}>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Registration form\r\n        </Typography>\r\n        <form className={classes.form} noValidate>\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"name\"\r\n            label=\"Name\"\r\n            name=\"name\"\r\n            autoComplete=\"name\"\r\n            onChange={(e) => action({ type: \"FILLNAME\", data: e.target.value })}\r\n          />\r\n          <TextField\r\n            variant=\"outlined\"\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            name=\"password\"\r\n            label=\"Password\"\r\n            type=\"password\"\r\n            id=\"password\"\r\n            onChange={(e) => action({ type: \"FILLPASSWORD\", data: e.target.value })}\r\n            autoComplete=\"current-password\"\r\n          />\r\n          <Button disabled={!data.filled} fullWidth variant=\"contained\" color=\"primary\" className={classes.submit} onClick={() => action(\"SUBMIT_CLICK\")}>\r\n            Submit\r\n          </Button>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" className={classes.submit} onClick={() => action(\"CANCEL_CLICK\")}>\r\n            Cancel\r\n          </Button>\r\n        </form>\r\n      </div>\r\n      <Box mt={8}>\r\n        <Copyright />\r\n      </Box>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default SignUp\r\n","import React from \"react\"\r\nimport Modal from \"@material-ui/core/Modal\"\r\nimport Typography from \"@material-ui/core/Typography\"\r\nimport Box from \"@material-ui/core/Box\"\r\nimport Button from \"@material-ui/core/Button\"\r\n\r\nconst SignInError = ({ action, data }) => {\r\n  const style = {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -50%)\",\r\n    width: 400,\r\n    bgcolor: \"background.paper\",\r\n    border: \"2px solid #000\",\r\n    boxShadow: 24,\r\n    p: 4,\r\n  }\r\n\r\n  return (\r\n    <Modal open={true} aria-labelledby=\"modal-modal-title\" aria-describedby=\"modal-modal-description\">\r\n      <Box sx={style}>\r\n        <Typography id=\"modal-modal-description\" sx={{ mt: 2 }}>\r\n          Username or password is incorrect\r\n        </Typography>\r\n        <Button onClick={() => action(\"OK\")}>OK</Button>\r\n      </Box>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default SignInError\r\n","import React from \"react\"\r\nimport Modal from \"@material-ui/core/Modal\"\r\nimport Typography from \"@material-ui/core/Typography\"\r\nimport Box from \"@material-ui/core/Box\"\r\nimport Button from \"@material-ui/core/Button\"\r\n\r\nconst SignUpError = ({ action, data }) => {\r\n  const style = {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -50%)\",\r\n    width: 400,\r\n    bgcolor: \"background.paper\",\r\n    border: \"2px solid #000\",\r\n    boxShadow: 24,\r\n    p: 4,\r\n  }\r\n\r\n  return (\r\n    <Modal open={true} aria-labelledby=\"modal-modal-title\" aria-describedby=\"modal-modal-description\">\r\n      <Box sx={style}>\r\n        <Typography id=\"modal-modal-description\" sx={{ mt: 2 }}>\r\n          {data.answer}\r\n        </Typography>\r\n        <Button onClick={() => action(\"OK\")}>OK</Button>\r\n      </Box>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default SignUpError\r\n","import React from \"react\"\r\nimport Button from \"@mui/material/Button\"\r\nimport Dialog from \"@mui/material/Dialog\"\r\nimport DialogContent from \"@mui/material/DialogContent\"\r\nimport DialogTitle from \"@mui/material/DialogTitle\"\r\nimport DialogActions from \"@mui/material/DialogActions\"\r\nimport DialogContentText from \"@mui/material/DialogContentText\"\r\n\r\nconst AddContactSuccess = ({ action }) => (\r\n  <Dialog open={true}>\r\n    <DialogTitle>Contact added</DialogTitle>\r\n    <DialogContent>\r\n      <DialogContentText> </DialogContentText>\r\n    </DialogContent>\r\n    <DialogActions>\r\n      <Button\r\n        onClick={() => {\r\n          action(\"OK\")\r\n        }}\r\n      >\r\n        OK\r\n      </Button>\r\n    </DialogActions>\r\n  </Dialog>\r\n)\r\n\r\nexport default AddContactSuccess\r\n","import React from \"react\"\r\nimport Button from \"@mui/material/Button\"\r\nimport Dialog from \"@mui/material/Dialog\"\r\nimport DialogContent from \"@mui/material/DialogContent\"\r\nimport DialogTitle from \"@mui/material/DialogTitle\"\r\nimport DialogActions from \"@mui/material/DialogActions\"\r\nimport DialogContentText from \"@mui/material/DialogContentText\"\r\n\r\nconst AddContactError = ({ action }) => (\r\n  <Dialog open={true}>\r\n    <DialogTitle>Can't add contact</DialogTitle>\r\n    <DialogContent>\r\n      <DialogContentText> </DialogContentText>\r\n    </DialogContent>\r\n    <DialogActions>\r\n      <Button onClick={() => action(\"OK\")}>OK</Button>\r\n      <Button onClick={() => action(\"TRYAGAIN\")}>Try again</Button>\r\n    </DialogActions>\r\n  </Dialog>\r\n)\r\n\r\nexport default AddContactError\r\n","import * as React from \"react\"\r\nimport Dialog from \"@mui/material/Dialog\"\r\nimport DialogContent from \"@mui/material/DialogContent\"\r\nimport DialogTitle from \"@mui/material/DialogTitle\"\r\nimport Box from \"@mui/material/Box\"\r\nimport CircularProgress from \"@mui/material/CircularProgress\"\r\n\r\nconst AddContactWait = () => {\r\n  return (\r\n    <Dialog open={true}>\r\n      <DialogTitle>Add contact</DialogTitle>\r\n      <DialogContent>\r\n        <Box sx={{ display: \"flex\" }}>\r\n          <CircularProgress color=\"inherit\" />\r\n        </Box>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default AddContactWait\r\n","import * as React from \"react\"\r\nimport Menu from \"@mui/material/Menu\"\r\nimport MenuItem from \"@mui/material/MenuItem\"\r\nimport IconButton from \"@mui/material/IconButton\"\r\nimport MenuIcon from \"@mui/icons-material/Menu\"\r\n\r\nconst NewChatMenu = ({ action }) => {\r\n  const [anchorEl, setAnchorEl] = React.useState(null)\r\n  const open = Boolean(anchorEl)\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget)\r\n  }\r\n  const handleClose = () => {\r\n    setAnchorEl(null)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <IconButton size=\"large\" edge=\"start\" color=\"inherit\" aria-label=\"menu\" sx={{ mr: 2 }} onClick={handleClick}>\r\n        <MenuIcon />\r\n      </IconButton>\r\n      <Menu\r\n        id=\"basic-menu\"\r\n        anchorEl={anchorEl}\r\n        open={open}\r\n        onClose={handleClose}\r\n        MenuListProps={{\r\n          \"aria-labelledby\": \"basic-button\",\r\n        }}\r\n      >\r\n        <MenuItem onClick={() => action(\"CANCEL\")}>Cancel</MenuItem>\r\n      </Menu>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default NewChatMenu\r\n","import * as React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport ListItemButton from \"@mui/material/ListItemButton\"\r\nimport ListItemText from \"@mui/material/ListItemText\"\r\nimport Divider from \"@mui/material/Divider\"\r\nimport ListItemAvatar from \"@mui/material/ListItemAvatar\"\r\nimport Avatar from \"@mui/material/Avatar\"\r\n\r\nconst NewChatCard = ({ chatName }) => {\r\n  return (\r\n    <Box>\r\n      <ListItemButton alignItems=\"flex-start\" onClick={() => {}}>\r\n        <ListItemAvatar>\r\n          <Avatar alt={chatName} src=\"/static/images/avatar/1.jpg\" />\r\n        </ListItemAvatar>\r\n        <ListItemText primary={chatName} />\r\n      </ListItemButton>\r\n      <Divider variant=\"inset\" component=\"li\" />\r\n    </Box>\r\n  )\r\n}\r\n\r\nexport default NewChatCard\r\n","import React from \"react\"\r\nimport AppBar from \"@mui/material/AppBar\"\r\nimport Box from \"@mui/material/Box\"\r\nimport Toolbar from \"@mui/material/Toolbar\"\r\nimport Typography from \"@mui/material/Typography\"\r\nimport List from \"@mui/material/List\"\r\nimport Grid from \"@mui/material/Grid\"\r\nimport Paper from \"@mui/material/Paper\"\r\nimport TextField from \"@mui/material/TextField\"\r\nimport Button from \"@mui/material/Button\"\r\nimport NewChatMenu from \"./MUI/NewChatMenu\"\r\nimport NewChatCard from \"./MUI/NewChatCard\"\r\n\r\nconst NewChat = ({ action, data }) => {\r\n  const x = document.getElementById(\"input-message\")\r\n  return (\r\n    <Grid container sx={{ height: \"100vh\", border: \"solid blue 0px\" }}>\r\n      <Grid item xs={12} style={{ height: \"10%\" }}>\r\n        <Box sx={{ flexGrow: 1 }}>\r\n          <AppBar position=\"static\">\r\n            <Toolbar>\r\n              <NewChatMenu action={action}></NewChatMenu>\r\n              <Typography variant=\"h6\" component=\"div\" sx={{ flexGrow: 1 }}>\r\n                {data.myName}\r\n              </Typography>\r\n              <Button color=\"inherit\" onClick={() => action(\"LOGOUT_CLICK\")}>\r\n                logout\r\n              </Button>\r\n            </Toolbar>\r\n          </AppBar>\r\n        </Box>\r\n      </Grid>\r\n      <Grid item xs={3} style={{ height: \"90%\", border: \"0px solid red\" }}>\r\n        <List sx={{ width: \"100%\", maxWidth: 360, bgcolor: \"background.paper\" }} style={{ height: \"92%\", overflow: \"auto\" }}>\r\n          <NewChatCard chatName={\"new chat with \" + data.activeContact} action={action}></NewChatCard>\r\n        </List>\r\n      </Grid>\r\n      <Grid container xs={9} justifyContent=\"center\" style={{ height: \"90%\", border: \"0px solid red\" }}>\r\n        <Grid item xs={12} style={{ height: \"80%\", border: \"solid 0px red\" }}>\r\n          <Paper sx={{ height: \"98%\", margin: \"0 1% 0% 1%\", border: \"solid 0px blue\" }}>\r\n            <List sx={{ height: \"97%\" }} style={{ overflow: \"auto\", display: \"flex\", flexDirection: \"column-reverse\" }}></List>\r\n          </Paper>\r\n        </Grid>\r\n        <Grid item xs={12} style={{ height: \"20%\", border: \"solid 0px red\" }}>\r\n          <Box sx={{ height: \"95%\", margin: \"0 1% 0% 1%\", border: \"solid 0px blue\", display: \"flex\", justifyContent: \"space-between\" }}>\r\n            <TextField\r\n              id=\"input-message\"\r\n              label=\"Insert your message\"\r\n              multiline\r\n              rows={4}\r\n              focused\r\n              style={{ width: \"90%\" }}\r\n              onChange={(e) => {\r\n                if (e.target.value.trim().length <= 1) action(\"RENDER\")\r\n                action({ type: \"TYPING\", data: e.target.value })\r\n              }}\r\n            />\r\n            <Button disabled={x ? !x.value.trim() : true} variant=\"contained\" style={{ height: \"93%\" }} onClick={() => action(\"STARTNEWCHAT\")}>\r\n              SEND\r\n            </Button>\r\n          </Box>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n  )\r\n}\r\n\r\nexport default NewChat\r\n","import * as React from \"react\"\r\nimport List from \"@mui/material/List\"\r\nimport ListItem from \"@mui/material/ListItem\"\r\nimport ListItemButton from \"@mui/material/ListItemButton\"\r\nimport ListItemText from \"@mui/material/ListItemText\"\r\nimport ListItemAvatar from \"@mui/material/ListItemAvatar\"\r\nimport Checkbox from \"@mui/material/Checkbox\"\r\nimport Avatar from \"@mui/material/Avatar\"\r\nimport Box from \"@mui/material/Box\"\r\nimport Typography from \"@mui/material/Typography\"\r\nimport Modal from \"@mui/material/Modal\"\r\nimport Button from \"@mui/material/Button\"\r\nimport TextField from \"@mui/material/TextField\"\r\n\r\nconst CreateGroupChat = ({ action, data }) => {\r\n  const style = {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -50%)\",\r\n    width: 400,\r\n    bgcolor: \"background.paper\",\r\n    border: \"2px solid #000\",\r\n    boxShadow: 24,\r\n    p: 4,\r\n    maxHeight: \"50%\",\r\n    overflow: \"auto\",\r\n  }\r\n\r\n  const [checked, setChecked] = React.useState([])\r\n  const [chatName, setChatName] = React.useState(\"\")\r\n  const [btnDisabled, setBtnDisabled] = React.useState(true)\r\n\r\n  const handleToggle = (value) => () => {\r\n    const currentIndex = checked.indexOf(value)\r\n    const newChecked = [...checked]\r\n\r\n    if (currentIndex === -1) {\r\n      newChecked.push(value)\r\n    } else {\r\n      newChecked.splice(currentIndex, 1)\r\n    }\r\n\r\n    setChecked(newChecked)\r\n    setBtnDisabled(newChecked.length === 0 || chatName === \"\")\r\n  }\r\n  const handleText = (value) => {\r\n    setChatName(value)\r\n    setBtnDisabled(checked.length === 0 || value === \"\")\r\n  }\r\n\r\n  return (\r\n    <Modal open={true} aria-labelledby=\"modal-modal-title\" aria-describedby=\"modal-modal-description\">\r\n      <Box sx={style}>\r\n        <Typography id=\"modal-modal-title\" variant=\"h6\" component=\"h2\">\r\n          Enter chat name\r\n        </Typography>\r\n        <TextField variant=\"outlined\" margin=\"normal\" required fullWidth onChange={(e) => handleText(e.target.value)} />\r\n        <Typography id=\"modal-modal-title\" variant=\"h6\" component=\"h2\">\r\n          Choose contacts to new group chat\r\n        </Typography>\r\n        <List dense sx={{ width: \"100%\", maxWidth: 360, bgcolor: \"background.paper\" }}>\r\n          {data.contacts.map((cont) => {\r\n            const labelId = `${cont.name}`\r\n            return (\r\n              <ListItem\r\n                key={cont.name}\r\n                secondaryAction={<Checkbox edge=\"end\" onChange={handleToggle(cont.name)} checked={checked.indexOf(cont.name) !== -1} inputProps={{ \"aria-labelledby\": labelId }} />}\r\n                disablePadding\r\n              >\r\n                <ListItemButton>\r\n                  <ListItemAvatar>\r\n                    <Avatar alt={`${cont.name}`} src={cont.photo} />\r\n                  </ListItemAvatar>\r\n                  <ListItemText id={labelId} primary={`${cont.name}`} />\r\n                </ListItemButton>\r\n              </ListItem>\r\n            )\r\n          })}\r\n        </List>\r\n        <Button disabled={btnDisabled} onClick={() => action({ type: \"SEND\", data: { checked, chatName } })}>\r\n          CREATE\r\n        </Button>\r\n        <Button onClick={() => action(\"CANCEL\")}>CANCEL</Button>\r\n      </Box>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default CreateGroupChat\r\n","import React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport Typography from \"@mui/material/Typography\"\r\nimport Modal from \"@mui/material/Modal\"\r\nimport Button from \"@mui/material/Button\"\r\n\r\nconst UploadPhoto = ({ action, data }) => {\r\n  const style = {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -50%)\",\r\n    width: 500,\r\n    height: \"50%\",\r\n    bgcolor: \"background.paper\",\r\n    border: \"2px solid #000\",\r\n    boxShadow: 24,\r\n    p: 4,\r\n    //maxHeight: \"50%\",\r\n    overflow: \"auto\",\r\n  }\r\n\r\n  const [photo, setPhoto] = React.useState(\"\")\r\n\r\n  const upload = () => {\r\n    const preview = document.getElementById(\"prev\")\r\n    const file = document.getElementById(\"upload-photo\").files[0]\r\n    const reader = new FileReader()\r\n    reader.addEventListener(\r\n      \"load\",\r\n      () => {\r\n        preview.src = reader.result\r\n        setPhoto(reader.result)\r\n      },\r\n      false\r\n    )\r\n    if (file) {\r\n      reader.readAsDataURL(file)\r\n    }\r\n  }\r\n  const emptyImgSrc = \"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D\"\r\n  return (\r\n    <Modal open={true} aria-labelledby=\"modal-modal-title\" aria-describedby=\"modal-modal-description\">\r\n      <Box sx={style}>\r\n        <Box sx={{ height: \"80%\", border: \"dashed 1px blue\" }}>\r\n          <img alt=\"\" src={data.photo || emptyImgSrc} id=\"prev\" style={{ height: \"100%\", width: \"100%\" }} />\r\n        </Box>\r\n        <Typography id=\"modal-modal-title\" variant=\"h6\" component=\"h2\">\r\n          Upload photo from your local disc\r\n        </Typography>\r\n\r\n        <label htmlFor=\"upload-photo\">\r\n          <input onChange={() => upload()} style={{ display: \"none\" }} id=\"upload-photo\" name=\"upload-photo\" type=\"file\" />\r\n\r\n          <Button component=\"span\">Choose photo</Button>\r\n        </label>\r\n\r\n        <Button disabled={photo === \"\"} onClick={() => action({ type: \"UPDATEPHOTO\", photo })}>\r\n          Update photo\r\n        </Button>\r\n\r\n        <Button disabled={data.photo === \"\"} onClick={() => action({ type: \"DELETEPHOTO\", photo })}>\r\n          Delete photo\r\n        </Button>\r\n\r\n        <Button onClick={() => action(\"CANCEL\")}>CANCEL</Button>\r\n      </Box>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default UploadPhoto\r\n","import * as React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport Typography from \"@mui/material/Typography\"\r\nimport Modal from \"@mui/material/Modal\"\r\nimport CircularProgress from \"@mui/material/CircularProgress\"\r\n\r\nconst CreateGroupChatWait = () => {\r\n  const style = {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -50%)\",\r\n    width: 400,\r\n    bgcolor: \"background.paper\",\r\n    border: \"2px solid #000\",\r\n    boxShadow: 24,\r\n    p: 4,\r\n    maxHeight: \"50%\",\r\n    overflow: \"auto\",\r\n  }\r\n\r\n  return (\r\n    <Modal open={true} aria-labelledby=\"modal-modal-title\" aria-describedby=\"modal-modal-description\">\r\n      <Box sx={style}>\r\n        <Typography id=\"modal-modal-title\" variant=\"h6\" component=\"h2\">\r\n          Waiting for server\r\n        </Typography>\r\n        <CircularProgress color=\"inherit\" />\r\n      </Box>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default CreateGroupChatWait\r\n","import React from \"react\"\r\nimport Box from \"@mui/material/Box\"\r\nimport Dialog from \"@mui/material/Dialog\"\r\nimport DialogContent from \"@mui/material/DialogContent\"\r\nimport CircularProgress from \"@mui/material/CircularProgress\"\r\n\r\nconst ServerWait = () => (\r\n  <Dialog open={true}>\r\n    <DialogContent>\r\n      <Box sx={{ display: \"flex\" }}>\r\n        <CircularProgress color=\"inherit\" />\r\n      </Box>\r\n    </DialogContent>\r\n  </Dialog>\r\n)\r\n\r\nexport default ServerWait\r\n","import ServerError from \"../react_components/ServerError.js\"\r\nimport ServerRequest from \"../react_components/ServerRequest.js\"\r\nimport StartChat from \"../react_components/StartChat.js\"\r\nimport Chats from \"../react_components/Chats.js\"\r\nimport Contacts from \"../react_components/Contacts.js\"\r\nimport LogOut from \"../react_components/Modals/LogOut.js\"\r\nimport AddContact from \"../react_components/Modals/AddContact.js\"\r\nimport SignIn from \"../react_components/SignIn.js\"\r\nimport SignUp from \"../react_components/SignUp.js\"\r\nimport SignInError from \"../react_components/SignInError.js\"\r\nimport SignUpError from \"../react_components/SignUpError.js\"\r\n//import RecoveryForm from \"../react_components/RecoveryForm.js\"\r\n//import RecoveryRequest from \"../react_components/RecoveryRequest.js\"\r\nimport AddContactSuccess from \"../react_components/Modals/AddContactSuccess.js\"\r\nimport AddContactError from \"../react_components/Modals/AddContactError.js\"\r\nimport AddContactWait from \"../react_components/Modals/AddContactWait.js\"\r\nimport NewChat from \"../react_components/NewChat.js\"\r\nimport CreateGroupChat from \"../react_components/Modals/CreateGroupChat.js\"\r\nimport UploadPhoto from \"../react_components/Modals/UploadPhoto.js\"\r\nimport CreateGroupChatWait from \"../react_components/Modals/CreateGroupChatWait.js\"\r\nimport ServerWait from \"../react_components/Modals/ServerWait\"\r\nimport ReactDOM from \"react-dom\"\r\nimport React from \"react\"\r\n\r\nconst renderService = (callback, onEvent) => {\r\n  onEvent((e) => {\r\n    ReactDOM.render(null, document.getElementById(\"modal\"))\r\n    switch (e.type) {\r\n      case \"SIGNIN\": {\r\n        ReactDOM.render(<SignIn action={callback} data={e} />, document.getElementById(\"root\"))\r\n        ReactDOM.render(\"\", document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"SIGNIN_REQUEST\": {\r\n        ReactDOM.render(<ServerRequest action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"SIGNINERROR\": {\r\n        ReactDOM.render(<SignInError action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"SERVERERROR\": {\r\n        ReactDOM.render(<ServerError action={callback} data={e} />, document.getElementById(\"root\"))\r\n        ReactDOM.render(\"\", document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"SIGNUP\": {\r\n        ReactDOM.render(<SignUp action={callback} data={e} />, document.getElementById(\"root\"))\r\n        ReactDOM.render(\"\", document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"SIGNUP_REQUEST\": {\r\n        ReactDOM.render(<ServerRequest action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"SIGNUPERROR\": {\r\n        ReactDOM.render(<SignUpError action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      // case \"RECOVERYFORM\": {\r\n      //   ReactDOM.render(<RecoveryForm action={callback} data={e} />, document.getElementById(\"root\"))\r\n      //   break\r\n      // }\r\n      // case \"RECOVERYREQUEST\": {\r\n      //   ReactDOM.render(<RecoveryRequest action={callback} data={e} />, document.getElementById(\"root\"))\r\n      //   break\r\n      // }\r\n      case \"START_CHAT\": {\r\n        ReactDOM.render(<StartChat action={callback} data={e} />, document.getElementById(\"root\"))\r\n        break\r\n      }\r\n      case \"CHATS\": {\r\n        ReactDOM.render(<Chats action={callback} data={e} />, document.getElementById(\"root\"))\r\n        ReactDOM.render(\"\", document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"CONTACTS\": {\r\n        ReactDOM.render(<Contacts action={callback} data={e} />, document.getElementById(\"root\"))\r\n        break\r\n      }\r\n      case \"LOGOUT\": {\r\n        ReactDOM.render(<LogOut action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"ADD_CONTACT\": {\r\n        ReactDOM.render(<AddContact action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"ADD_CONTACT_WAIT\": {\r\n        ReactDOM.render(<AddContactWait action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"ADD_CONTACT_SUCCESS\": {\r\n        ReactDOM.render(<AddContactSuccess action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"ADD_CONTACT_ERROR\": {\r\n        ReactDOM.render(<AddContactError action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"NEW_CHAT\": {\r\n        ReactDOM.render(<NewChat action={callback} data={e} />, document.getElementById(\"root\"))\r\n        break\r\n      }\r\n      case \"CREATE_GROUP_CHAT\": {\r\n        ReactDOM.render(<CreateGroupChat action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"CREATE_GROUP_CHAT_WAIT\": {\r\n        ReactDOM.render(<CreateGroupChatWait action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"UPLOAD_PHOTO\": {\r\n        ReactDOM.render(<UploadPhoto action={callback} data={e} />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      case \"SERVER_WAIT\": {\r\n        ReactDOM.render(<ServerWait />, document.getElementById(\"modal\"))\r\n        break\r\n      }\r\n      default:\r\n        console.log(\"unknown state: \", e.type)\r\n    }\r\n  })\r\n}\r\n\r\nexport default renderService\r\n","const signInRequest = async (event, callback) => {\r\n  try {\r\n    const { name, password } = event\r\n    const response = await fetch(\"/SIGNIN\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify({ name, password }),\r\n    })\r\n\r\n    const answer = await response.json()\r\n    return answer.token ? callback({ type: \"SUCCESS\", token: answer.token, myName: answer.name, key: answer.subsKey }) : callback({ type: \"ERROR\", answer })\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default signInRequest\r\n","const signUpRequest = async (event, callback) => {\r\n  try {\r\n    const { name, password, publicKey } = event\r\n    const response = await fetch(\"/SIGNUP\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify({ name, password, publicKey }),\r\n    })\r\n\r\n    const answer = await response.json()\r\n    return answer.token ? callback({ type: \"SUCCESS\", token: answer.token, myName: answer.name, key: answer.subsKey }) : callback({ type: \"ERROR\", answer })\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default signUpRequest\r\n","const heartbeat = async (event) => {\r\n  const { token } = event\r\n  fetch(\"/HEARTBEAT\", {\r\n    headers: {\r\n      Accept: \"application/json\",\r\n      \"Content-Type\": \"application/json\",\r\n      token,\r\n    },\r\n    method: \"POST\",\r\n  })\r\n}\r\n\r\nexport default heartbeat\r\n","const addContactRequest = async (event, callback) => {\r\n  try {\r\n    const { token, addingContact } = { ...event }\r\n    const response = await fetch(\"/ADDCONTACT\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token,\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify({ addingContact }),\r\n    })\r\n    const answer = await response.json()\r\n    return answer.name ? callback(\"OK\") : callback(\"ERROR\")\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default addContactRequest\r\n","const changePhotoRequest = async (event, callback) => {\r\n  try {\r\n    const { photo, token, myName } = { ...event }\r\n    const response = await fetch(\"/CHANGEPHOTO\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token,\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify({ photo, myName }),\r\n    })\r\n    const answer = await response.json()\r\n    return callback({ type: \"SUCCESS\", photo: answer.photo })\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default changePhotoRequest\r\n","const sendMessageRequest = async (event, callback) => {\r\n  try {\r\n    const { chats, activeChat, token } = { ...event }\r\n    const message = chats.find((ch) => ch.chatId === activeChat).typingMessage\r\n    const response = await fetch(\"/SENDMESSAGE\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token,\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify({ message, activeChat }),\r\n    })\r\n    const answer = await response.json()\r\n    return callback({ type: \"OK\", ...answer })\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default sendMessageRequest\r\n","const updateRequest = async (event, callback) => {\r\n  try {\r\n    const { token } = { ...event }\r\n    const response = await fetch(\"/UPDATE\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token,\r\n      },\r\n      method: \"GET\",\r\n    })\r\n    const answer = await response.json()\r\n    return callback({ type: \"DATARECIEVED\", contacts: answer.contacts, chats: answer.chats, photo: answer.photo })\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default updateRequest\r\n","const createPrivateChatRequest = async (event, callback) => {\r\n  try {\r\n    const { message, activeContact, token, myName } = { ...event }\r\n    const response = await fetch(\"/CREATEPRIVATECHAT\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token,\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify({ message, activeContact, myName }),\r\n    })\r\n    const answer = await response.json()\r\n    return callback({ type: \"SUCCESS\", insertedId: answer.insertedId })\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default createPrivateChatRequest\r\n","const createGroupChatRequest = async (event, callback) => {\r\n  try {\r\n    const { groupChatData, token, myName } = { ...event }\r\n    const response = await fetch(\"/CREATEGROUPCHAT\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token,\r\n      },\r\n      method: \"POST\",\r\n      body: JSON.stringify({ groupChatData, myName }),\r\n    })\r\n    const answer = await response.json()\r\n    return callback({ type: \"SUCCSESS\", ...answer })\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default createGroupChatRequest\r\n","const subscribe = async (event, callback) => {\r\n  try {\r\n    const { token } = { ...event }\r\n    const response = await fetch(\"/SUBSCRIBE\", {\r\n      headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json\",\r\n        token,\r\n      },\r\n      method: \"POST\",\r\n    })\r\n    const reader = response.body.getReader()\r\n\r\n    while (true) {\r\n      const { value } = await reader.read()\r\n      const { message } = JSON.parse(String.fromCharCode.apply(null, value))\r\n      switch (message) {\r\n        case \"subscribed\":\r\n          callback(\"SUBSCRIBED\")\r\n          break\r\n        case \"heartbeat\":\r\n          callback(\"HEARTBEAT\")\r\n          break\r\n        case \"update\":\r\n          callback(\"UPDATE\")\r\n          break\r\n        default:\r\n          break\r\n      }\r\n    }\r\n  } catch (error) {\r\n    callback(\"NETWORKERROR\")\r\n  }\r\n}\r\n\r\nexport default subscribe\r\n","import signInRequest from \"../requests/signInRequest.js\"\r\nimport signUpRequest from \"../requests/signUpRequest.js\"\r\nimport heartbeat from \"../requests/heartbeat.js\"\r\nimport addContactRequest from \"../requests/addContactRequest.js\"\r\nimport changePhotoRequest from \"../requests/changePhotoRequest.js\"\r\nimport sendMessageRequest from \"../requests/sendMessageRequest.js\"\r\nimport updateRequest from \"../requests/updateRequest.js\"\r\nimport createPrivateChatRequest from \"../requests/createPrivateChatRequest.js\"\r\nimport createGroupChatRequest from \"../requests/createGroupChatRequest.js\"\r\nimport subscribe from \"../requests/subscribe.js\"\r\n\r\nconst networkService = (callback, onEvent) => {\r\n  onEvent((event) => {\r\n    switch (event.type) {\r\n      case \"HEARTBEAT\":\r\n        heartbeat(event)\r\n        break\r\n\r\n      case \"SIGNIN_REQUEST\":\r\n        signInRequest(event, callback)\r\n        break\r\n\r\n      case \"SIGNUP_REQUEST\":\r\n        signUpRequest(event, callback)\r\n        break\r\n\r\n      case \"GET_DATA\":\r\n        updateRequest(event, callback)\r\n        break\r\n\r\n      case \"ADD_CONTACT\":\r\n        addContactRequest(event, callback)\r\n        break\r\n\r\n      case \"SUBSCRIBE\":\r\n        subscribe(event, callback)\r\n        break\r\n\r\n      case \"SEND_MESSAGE\":\r\n        sendMessageRequest(event, callback)\r\n        break\r\n\r\n      case \"CREATE_NEW_CHAT\":\r\n        createPrivateChatRequest(event, callback)\r\n        break\r\n\r\n      case \"CREATE_GROUP_CHAT\":\r\n        createGroupChatRequest(event, callback)\r\n        break\r\n\r\n      case \"CHANGE_PHOTO\":\r\n        changePhotoRequest(event, callback)\r\n        break\r\n\r\n      default:\r\n        console.log(\"unexpected action: \", event.type)\r\n    }\r\n  })\r\n}\r\n\r\nexport default networkService\r\n","import { createMachine, assign, send, sendParent, spawn } from \"xstate\"\r\nimport renderService from \"../services/renderService.js\"\r\nimport networkService from \"../services/networkService.js\"\r\nimport cryptico from \"cryptico\"\r\n\r\nconst loginMachine = createMachine(\r\n  {\r\n    id: \"Login\",\r\n    initial: \"signIn\",\r\n    context: {},\r\n    entry: [\r\n      assign({\r\n        renderServiceRef: () => spawn(renderService, \"render\"),\r\n      }),\r\n      assign({\r\n        networkServiceRef: () => spawn(networkService, \"network\"),\r\n      }),\r\n    ],\r\n    states: {\r\n      signIn: {\r\n        initial: \"notFilled\",\r\n        entry: [\"resetName\", \"resetPassword\"],\r\n        on: {\r\n          SIGNUP_CLICK: \"signUp\",\r\n          SIGNIN_CLICK: \"signInRequest\",\r\n        },\r\n\r\n        states: {\r\n          notFilled: {\r\n            entry: [send((ctx) => ({ type: \"SIGNIN\", ...ctx, filled: false }), { to: \"render\" })],\r\n            on: {\r\n              FILLNAME: { actions: [\"fillName\", send(\"CHANGESTATE\")] },\r\n              FILLPASSWORD: { actions: [\"fillPassword\", send(\"CHANGESTATE\")] },\r\n              CHANGESTATE: { target: \"filled\", cond: ({ name, password }) => name && password },\r\n            },\r\n          },\r\n          filled: {\r\n            entry: [send((ctx) => ({ type: \"SIGNIN\", ...ctx, filled: true }), { to: \"render\" })],\r\n            on: {\r\n              FILLNAME: { actions: [\"fillName\", send(\"CHANGESTATE\")] },\r\n              FILLPASSWORD: { actions: [\"fillPassword\", send(\"CHANGESTATE\")] },\r\n              CHANGESTATE: { target: \"notFilled\", cond: ({ name, password }) => !(name && password) },\r\n            },\r\n          },\r\n        },\r\n      },\r\n\r\n      signInRequest: {\r\n        entry: [\"generateRSAKey\", \"getPublicKey\", send(() => ({ type: \"SIGNIN_REQUEST\" }), { to: \"render\" }), send((ctx) => ({ type: \"SIGNIN_REQUEST\", ...ctx }), { to: \"network\" })],\r\n        on: {\r\n          SUCCESS: {\r\n            target: \"finish\",\r\n            actions: [assign({ token: (c, e) => e.token }), assign({ myName: (c, e) => e.myName }), assign({ key: (c, e) => e.key })],\r\n          },\r\n          ERROR: \"signInError\",\r\n          NETWORKERROR: \"serverError\",\r\n        },\r\n      },\r\n\r\n      signUp: {\r\n        entry: [\"resetName\", \"resetPassword\", send((ctx) => ({ type: \"SIGNUP\", ...ctx }), { to: \"render\" })],\r\n        on: {\r\n          CANCEL_CLICK: \"signIn\",\r\n          SUBMIT_CLICK: \"signUpRequest\",\r\n        },\r\n        initial: \"notFilled\",\r\n        states: {\r\n          notFilled: {\r\n            entry: [send((ctx) => ({ type: \"SIGNUP\", ...ctx, filled: false }), { to: \"render\" })],\r\n            on: {\r\n              FILLNAME: { actions: [\"fillName\", send(\"CHANGESTATE\")] },\r\n              FILLPASSWORD: { actions: [\"fillPassword\", send(\"CHANGESTATE\")] },\r\n              CHANGESTATE: { target: \"filled\", cond: ({ name, password }) => name && password },\r\n            },\r\n          },\r\n          filled: {\r\n            entry: [send((ctx) => ({ type: \"SIGNUP\", ...ctx, filled: true }), { to: \"render\" })],\r\n            on: {\r\n              FILLNAME: { actions: [\"fillName\", send(\"CHANGESTATE\")] },\r\n              FILLPASSWORD: { actions: [\"fillPassword\", send(\"CHANGESTATE\")] },\r\n              CHANGESTATE: { target: \"notFilled\", cond: ({ name, password }) => !(name && password) },\r\n            },\r\n          },\r\n        },\r\n      },\r\n\r\n      signUpRequest: {\r\n        entry: [\"generateRSAKey\", \"getPublicKey\", send(() => ({ type: \"SIGNUP_REQUEST\" }), { to: \"render\" }), send((ctx) => ({ type: \"SIGNUP_REQUEST\", ...ctx }), { to: \"network\" })],\r\n        on: {\r\n          SUCCESS: { target: \"finish\", actions: [assign({ token: (c, e) => e.token }), assign({ myName: (c, e) => e.myName }), assign({ key: (c, e) => e.key })] },\r\n          ERROR: \"signUpError\",\r\n          NETWORKERROR: \"serverError\",\r\n        },\r\n      },\r\n\r\n      signInError: {\r\n        entry: [send(() => ({ type: \"SIGNINERROR\" }), { to: \"render\" })],\r\n        on: {\r\n          OK: \"signIn\",\r\n        },\r\n      },\r\n\r\n      signUpError: {\r\n        entry: send((ctx, e) => ({ type: \"SIGNUPERROR\", answer: e.answer }), { to: \"render\" }),\r\n        on: {\r\n          OK: \"signUp\",\r\n        },\r\n      },\r\n\r\n      finish: {\r\n        entry: [sendParent((ctx) => ({ type: \"FINISH\", ...ctx }))],\r\n        type: \"final\",\r\n      },\r\n\r\n      serverError: {\r\n        entry: send((cxt) => ({ type: \"SERVERERROR\" }), { to: \"render\" }),\r\n        type: \"final\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    actions: {\r\n      generateRSAKey: assign({ RSAkey: (ctx) => cryptico.generateRSAKey(ctx.password, 1024) }),\r\n      getPublicKey: assign({ publicKey: (ctx) => cryptico.publicKeyString(ctx.RSAkey) }),\r\n      fillName: assign({ name: (context, event) => event.data || \"\" }),\r\n      fillPassword: assign({ password: (context, event) => event.data || \"\" }),\r\n      contextlog: (ctx) => console.log(\"actual context: \", ctx),\r\n      resetName: assign({ name: \"\" }),\r\n      resetPassword: assign({ password: \"\" }),\r\n      renderSignInPage: send((ctx) => ({ type: \"SIGNIN\", ...ctx }), { to: \"render\" }),\r\n      renderFinisWithError: send((cxt) => ({ type: \"FINISHWITHERROR\", ...cxt }), { to: (context) => context.renderServiceRef }),\r\n    },\r\n  }\r\n)\r\n\r\nexport default loginMachine\r\n","import { createMachine, assign, send, sendParent, spawn } from \"xstate\"\r\nimport renderService from \"../services/renderService.js\"\r\nimport networkService from \"../services/networkService\"\r\nimport cryptico from \"cryptico\"\r\n\r\nconst chatMachine = createMachine(\r\n  {\r\n    id: \"chatMachine\",\r\n    initial: \"loading\",\r\n    entry: [\r\n      assign({\r\n        renderServiceRef: () => spawn(renderService, \"render\"),\r\n      }),\r\n      assign({\r\n        networkServiceRef: () => spawn(networkService, \"network\"),\r\n      }),\r\n    ],\r\n    on: {\r\n      UPDATE: { actions: \"getData\" },\r\n      DATARECIEVED: { actions: [\"updateContacts\", \"updateChats\", \"updatePhoto\"] },\r\n      HEARTBEAT: { actions: \"sendHeartBeat\" },\r\n    },\r\n    states: {\r\n      loading: {\r\n        entry: [\"renderLoadingPage\", \"subscribeToServerEvents\"],\r\n        on: {\r\n          SUBSCRIBED: { actions: \"getData\" },\r\n          DATARECIEVED: { target: \"main\", actions: [\"updateContacts\", \"updateChats\", \"updatePhoto\"] },\r\n        },\r\n      },\r\n      main: {\r\n        initial: \"choosingChat\",\r\n        on: {\r\n          ADDCONTACT: \"addContactState\",\r\n          CREATEGROUPCHAT: \"createGroupChat\",\r\n          LOGOUT_CLICK: \"logOut\",\r\n          CHANGEAVATAR: \"uploadPhoto\",\r\n        },\r\n        states: {\r\n          choosingChat: {\r\n            entry: [\"renderChat\", \"clearActiveContact\"],\r\n            on: {\r\n              CHANGEACTIVE: { target: \"choosingChat\", actions: [assign({ activeChat: (c, e) => e.chatId })] },\r\n              SWITCHTOCONTACTS: \"choosingContact\",\r\n              TYPING: {\r\n                actions: [\r\n                  assign({\r\n                    chats: (c, e) => {\r\n                      c.chats.find((ch) => ch.chatId === c.activeChat).typingMessage = e.data\r\n                      return c.chats\r\n                    },\r\n                  }),\r\n                ],\r\n              },\r\n              RENDER: { actions: \"renderChat\" },\r\n              SENDMESSAGE: { actions: \"sendMessage\" },\r\n              UPDATE: { actions: \"getData\" },\r\n              OK: { actions: [\"updateContacts\", \"updateChats\", \"updatePhoto\", \"renderChat\"] },\r\n              DATARECIEVED: { actions: [\"updateContacts\", \"updateChats\", \"updatePhoto\", \"renderChat\"] },\r\n              CLEARINPUT: { actions: [\"clearMessage\", \"renderChat\"] },\r\n            },\r\n\r\n            exit: \"resetMessage\",\r\n          },\r\n          choosingContact: {\r\n            entry: \"renderContacts\",\r\n            on: {\r\n              CHANGEACTIVE: { target: \"choosingContact\", actions: [assign({ activeContact: (c, e) => e.contact })] },\r\n              SWITCHTOCHATS: \"choosingChat\",\r\n              STARTCHAT: [\r\n                {\r\n                  target: \"choosingChat\",\r\n                  actions: assign({ activeChat: (c) => c.chats.find((ch) => ch.chatName === c.activeContact).chatId }),\r\n                  cond: (c) => c.chats.some((chat) => chat.chatName === c.activeContact),\r\n                },\r\n                { target: \"newChat\" },\r\n              ],\r\n            },\r\n          },\r\n          newChat: {\r\n            entry: \"renderNewChat\",\r\n            initial: \"idle\",\r\n            states: {\r\n              idle: {\r\n                on: {\r\n                  CANCEL: \"#chatMachine.main.choosingChat\",\r\n                  TYPING: { actions: assign({ message: (c, e) => e.data }) },\r\n                  RENDER: { actions: \"renderNewChat\" },\r\n                  STARTNEWCHAT: \"creatingNewChat\",\r\n                },\r\n              },\r\n\r\n              creatingNewChat: {\r\n                entry: [\"renderSerwerWait\", \"createChat\"],\r\n                on: {\r\n                  SUCCESS: { target: \"sendingMessage\", actions: [\"updateActiveChatId\"] },\r\n                  ERROR: \"errorState\",\r\n                },\r\n              },\r\n              sendingMessage: {\r\n                entry: [\r\n                  assign({\r\n                    chats: (c, e) => {\r\n                      c.chats.push({ chatId: c.activeChat, typingMessage: c.message, messages: [] })\r\n                      return c.chats\r\n                    },\r\n                  }),\r\n                  \"sendMessage\",\r\n                ],\r\n                on: {\r\n                  OK: \"#chatMachine.main.choosingChat\",\r\n                  NETWORKERROR: \"errorState\",\r\n                },\r\n              },\r\n              errorState: {\r\n                entry: \"serverError\",\r\n                type: \"final\",\r\n              },\r\n            },\r\n            exit: [\"resetMessage\"],\r\n          },\r\n          hist: {\r\n            type: \"history\",\r\n          },\r\n        },\r\n      },\r\n      addContactState: {\r\n        initial: \"idle\",\r\n        states: {\r\n          idle: {\r\n            entry: [\"resetContact\", \"renderAddContact\"],\r\n\r\n            on: {\r\n              TYPING: { actions: assign({ addingContact: (c, e) => e.data }) },\r\n              CANCEL: \"#chatMachine.main.choosingChat\",\r\n              SUBMIT: \"waitingForServer\",\r\n            },\r\n          },\r\n          waitingForServer: {\r\n            entry: [send((ctx) => ({ type: \"ADD_CONTACT_WAIT\", ...ctx }), { to: \"render\" }), send((ctx) => ({ type: \"ADD_CONTACT\", ...ctx }), { to: \"network\" })],\r\n            exit: \"resetContact\",\r\n            on: {\r\n              OK: { target: \"sucessState\", actions: \"getData\" },\r\n              ERROR: \"errorState\",\r\n            },\r\n          },\r\n          sucessState: {\r\n            entry: send((ctx) => ({ type: \"ADD_CONTACT_SUCCESS\", ...ctx }), { to: \"render\" }),\r\n            on: {\r\n              OK: \"#chatMachine.main.choosingContact\",\r\n            },\r\n          },\r\n          errorState: {\r\n            entry: send((ctx) => ({ type: \"ADD_CONTACT_ERROR\", ...ctx }), { to: \"render\" }),\r\n            on: {\r\n              OK: \"#chatMachine.main.choosingChat\",\r\n              TRYAGAIN: \"idle\",\r\n            },\r\n          },\r\n        },\r\n      },\r\n      uploadPhoto: {\r\n        initial: \"upload\",\r\n        states: {\r\n          upload: {\r\n            entry: send((ctx) => ({ type: \"UPLOAD_PHOTO\", ...ctx }), { to: \"render\" }),\r\n            on: {\r\n              UPDATEPHOTO: {\r\n                target: \"waitingForServer\",\r\n              },\r\n              DELETEPHOTO: {\r\n                target: \"waitingForServer\",\r\n                actions: [assign({ photo: \"\" })],\r\n              },\r\n              CANCEL: \"#chatMachine.main.hist\",\r\n            },\r\n          },\r\n          waitingForServer: {\r\n            entry: [send((ctx, e) => ({ type: \"CHANGE_PHOTO\", ...ctx, photo: e.photo }), { to: \"network\" })],\r\n            on: {\r\n              SUCCESS: {\r\n                target: \"#chatMachine.main.hist\",\r\n                actions: assign({ photo: (c, e) => e.photo }),\r\n              },\r\n            },\r\n          },\r\n          sucessState: {\r\n            entry: \"#chatMachine.main.choosingChat\",\r\n          },\r\n          errorState: {\r\n            entry: \"serverError\",\r\n            type: \"final\",\r\n          },\r\n        },\r\n      },\r\n      logOut: {\r\n        entry: [\"renderLogOut\"],\r\n        on: {\r\n          YES: \"exit\",\r\n          NO: \"main.hist\",\r\n        },\r\n      },\r\n      createGroupChat: {\r\n        initial: \"idle\",\r\n        states: {\r\n          idle: {\r\n            entry: [\"renderCreateGroupChat\"],\r\n            on: {\r\n              SEND: { target: \"waitingForServer\", actions: assign({ groupChatData: (c, e) => e.data }) },\r\n              CANCEL: \"#chatMachine.main.hist\",\r\n            },\r\n          },\r\n          waitingForServer: {\r\n            entry: [send((ctx) => ({ type: \"CREATE_GROUP_CHAT_WAIT\", ...ctx }), { to: \"render\" }), send((ctx) => ({ type: \"CREATE_GROUP_CHAT\", ...ctx }), { to: \"network\" })],\r\n            on: {\r\n              SUCCSESS: { actions: [\"updateContacts\", \"updateChats\", \"updatePhoto\", \"updateActiveChatId\"], target: \"#chatMachine.main.choosingChat\" },\r\n            },\r\n          },\r\n        },\r\n      },\r\n      exit: {\r\n        entry: [sendParent(() => ({ type: \"FINISH\" }))],\r\n        type: \"final\",\r\n      },\r\n    },\r\n  },\r\n  {\r\n    actions: {\r\n      subscribeToServerEvents: send((ctx) => ({ type: \"SUBSCRIBE\", ...ctx }), { to: \"network\" }),\r\n      sendHeartBeat: send((ctx) => ({ type: \"HEARTBEAT\", ...ctx }), { to: \"network\" }),\r\n      contextlog: (ctx) => console.log(\"actual context: \", ctx),\r\n      setContacts: assign({ contacts: true }),\r\n      setChats: assign({ chats: true }),\r\n      renderChat: send((ctx) => ({ type: \"CHATS\", ...ctx }), { to: \"render\" }),\r\n      resetContact: assign({ addingContact: \"\" }),\r\n      resetMessage: assign({ message: \"\" }),\r\n      getData: send((ctx) => ({ type: \"GET_DATA\", ...ctx }), { to: \"network\" }),\r\n      sendMessage: send((ctx) => ({ type: \"SEND_MESSAGE\", ...ctx }), { to: \"network\" }),\r\n      createChat: send((ctx) => ({ type: \"CREATE_NEW_CHAT\", ...ctx }), { to: \"network\" }),\r\n      renderLoadingPage: send((ctx) => ({ type: \"START_CHAT\", ...ctx }), { to: \"render\" }),\r\n      renderNewChat: send((ctx) => ({ type: \"NEW_CHAT\", ...ctx }), { to: \"render\" }),\r\n      renderAddContact: send((ctx) => ({ type: \"ADD_CONTACT\", ...ctx }), { to: \"render\" }),\r\n      renderCreateGroupChat: send((ctx) => ({ type: \"CREATE_GROUP_CHAT\", ...ctx }), { to: \"render\" }),\r\n      updateContacts: assign({ contacts: (c, e) => e.contacts }),\r\n      updateChats: assign({\r\n        chats: (ctx, e) => {\r\n          return e.chats.map(({ chatId, chatName, messages }) => ({\r\n            chatId,\r\n            chatName,\r\n            messages: messages.map(({ name, message }) => ({ name, message: cryptico.decrypt(message, ctx.RSAkey).plaintext })),\r\n          }))\r\n        },\r\n      }),\r\n      updatePhoto: assign({ photo: (c, e) => e.photo }),\r\n      updateActiveChatId: assign({ activeChat: (c, e) => e.insertedId }),\r\n      renderContacts: send((ctx) => ({ type: \"CONTACTS\", ...ctx }), { to: \"render\" }),\r\n      clearActiveContact: assign({ activeContact: (c, e) => \"\" }),\r\n      clearActiveChat: assign({ activeChat: (c, e) => \"\" }),\r\n      clearMessage: assign({\r\n        chats: (c, e) => {\r\n          c.chats.find((ch) => ch.chatId === c.activeChat).typingMessage = \"\"\r\n          return c.chats\r\n        },\r\n      }),\r\n      renderSerwerWait: send((ctx) => ({ type: \"SERVER_WAIT\", ...ctx }), { to: \"render\" }),\r\n      renderLogOut: send((ctx) => ({ type: \"LOGOUT\", ...ctx }), { to: \"render\" }),\r\n      serverError: send(() => ({ type: \"SERVERERROR\" }), { to: \"render\" }),\r\n    },\r\n  }\r\n)\r\n\r\nexport default chatMachine\r\n","import { createMachine, interpret, assign } from \"xstate\"\nimport loginMachine from \"./machines/loginMachine.js\"\nimport chatMachine from \"./machines/chatMachine.js\"\n\nfunction app() {\n  const appMachine = createMachine({\n    id: \"app\",\n    initial: \"login\",\n    context: {},\n    states: {\n      login: {\n        invoke: {\n          id: \"loginMachine\",\n          src: loginMachine,\n        },\n        on: {\n          FINISH: {\n            target: \"chat\",\n            actions: [assign({ token: (context, event) => event.token }), assign({ myName: (context, event) => event.myName }), assign({ RSAkey: (c, e) => e.RSAkey })],\n          },\n        },\n      },\n      chat: {\n        invoke: {\n          id: \"chatMachine\",\n          src: chatMachine,\n          data: {\n            token: (context) => context.token,\n            myName: (context) => context.myName,\n            RSAkey: (context) => context.RSAkey,\n            activeChat: \"\",\n          },\n        },\n        on: {\n          FINISH: {\n            target: \"login\",\n            actions: [assign({ token: \"\" }), assign({ myName: \"\" }), assign({ RSAkey: \"\" })],\n          },\n        },\n      },\n    },\n  })\n\n  interpret(appMachine).start()\n}\n\nexport default app\n","import \"./index.css\"\nimport App from \"./App\"\n\nApp()\n"],"sourceRoot":""}