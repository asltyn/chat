(this.webpackJsonpfsm=this.webpackJsonpfsm||[]).push([[0],{301:function(e,t,n){},321:function(e,t){},323:function(e,t){},333:function(e,t){},335:function(e,t){},362:function(e,t){},364:function(e,t){},365:function(e,t){},370:function(e,t){},372:function(e,t){},378:function(e,t){},380:function(e,t){},399:function(e,t){},411:function(e,t){},414:function(e,t){},417:function(e,t,n){"use strict";n.r(t);n(301);var a=n(509),r=n(26),c=n(499),o=n(16),i=n(2),s=function(){return Object(i.jsx)("div",{children:Object(i.jsx)("h1",{children:"Server error. Try again Later"})})},d=n(0),l=n.n(d),u=n(515),b=n(482),j=function(){return Object(i.jsx)(u.a,{style:{zIndex:1},open:!0,children:Object(i.jsx)(b.a,{color:"inherit"})})},h=function(){return Object(i.jsx)("div",{children:Object(i.jsx)("div",{children:Object(i.jsx)("h1",{children:"START CHAT"})})})},O=n(517),p=n(519),m=n(511),x=n(516),f=n(500),C=n(512),g=n(528),y=n(529),E=n(128),A=function(e){var t=e.data,n=(e.action,e.message);return Object(i.jsx)(g.a,{sx:{width:"50%",margin:"10px",alignSelf:n.name===t.myName?"flex-end":"flex-start"},children:Object(i.jsxs)(y.a,{children:[Object(i.jsx)(E.a,{gutterBottom:!0,variant:"body2",component:"div",children:"name: "+n.name}),Object(i.jsx)(E.a,{variant:"body2",color:"text.secondary",children:n.message})]})})},S=n(485),T=n(486),v=n(487),R=n(518),N=n(510),k=function(e){var t=e.data,n=e.action,a=t.chatName,r=t.chatId,c=t.messages,o=t.photo,s=t.activeChat,l="";if(c.length>0){var u=c.slice(-1)[0],b=u.name,j=u.message;l="".concat(b,": ").concat(j)}return Object(i.jsxs)(O.a,{children:[Object(i.jsxs)(S.a,{sx:{backgroundColor:r===s?"rgba(0, 0, 0, 0.05)":""},alignItems:"flex-start",onClick:function(){return n({type:"CHANGEACTIVE",chatId:r})},children:[Object(i.jsx)(R.a,{children:Object(i.jsx)(N.a,{alt:a,src:o})}),Object(i.jsx)(T.a,{primary:a,secondary:Object(i.jsx)(d.Fragment,{children:Object(i.jsx)(E.a,{sx:{display:"inline"},component:"span",variant:"body2",color:"text.primary",children:l})})})]}),Object(i.jsx)(v.a,{variant:"inset",component:"li"})]})},I=n(520),w=n(521),P=n(20),D=n(273),G=n(513),U=n(530),H=n(152),L=n.n(H),_=function(e){var t=e.action,n=d.useState(null),a=Object(P.a)(n,2),r=a[0],c=a[1],o=Boolean(r),s=function(){c(null)};return Object(i.jsxs)("div",{children:[Object(i.jsx)(U.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},onClick:function(e){c(e.currentTarget)},children:Object(i.jsx)(L.a,{})}),Object(i.jsxs)(D.a,{id:"basic-menu",anchorEl:r,open:o,onClose:s,MenuListProps:{"aria-labelledby":"basic-button"},children:[Object(i.jsx)(G.a,{onClick:function(){return t("SWITCHTOCHATS")},children:"Chats"}),Object(i.jsx)(G.a,{onClick:function(){return t("SWITCHTOCONTACTS")},children:"Contacts"}),Object(i.jsx)(G.a,{onClick:function(){s(),t("ADDCONTACT")},children:"Add contact"}),Object(i.jsx)(G.a,{onClick:function(){s(),t("CREATEGROUPCHAT")},children:"Create group chat"})]})]})},B=function(e){var t=e.data,n=e.action;return Object(i.jsx)(m.a,{item:!0,xs:12,style:{height:"10%"},children:Object(i.jsx)(O.a,{sx:{flexGrow:1},children:Object(i.jsx)(I.a,{position:"static",children:Object(i.jsxs)(w.a,{children:[Object(i.jsx)(_,{action:n}),Object(i.jsx)(R.a,{children:Object(i.jsx)(N.a,{style:{cursor:"pointer"},onClick:function(){return n("CHANGEAVATAR")},src:t.photo})}),Object(i.jsx)(E.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:t.myName}),Object(i.jsx)(C.a,{color:"inherit",onClick:function(){return n("LOGOUT_CLICK")},children:"logout"})]})})})})},K=function(e){var t=e.action,n=e.data,a=function(e){if(!e.activeChat)return"";var t=e.chats.find((function(t){return t.chatId===e.activeChat})).chatId;return void 0===t?"":e.chats.find((function(e){return e.chatId===t})).messages.map((function(t){return Object(i.jsx)(A,{data:e,message:t})}))}(n),r=document.getElementById("input-message");return r&&(r.value=(n.chats.find((function(e){return e.chatId===n.activeChat}))||{}).typingMessage||""),Object(i.jsxs)(m.a,{container:!0,sx:{height:"100vh",border:"solid blue 0px"},children:[Object(i.jsx)(B,{action:t,data:n}),Object(i.jsx)(m.a,{item:!0,xs:3,style:{height:"90%",border:"0px solid red"},children:Object(i.jsx)(p.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},style:{height:"92%",overflow:"auto"},children:n.chats.map((function(e){return Object(i.jsx)(k,{data:Object(o.a)(Object(o.a)({},e),{},{activeChat:n.activeChat}),action:t})}))})}),Object(i.jsxs)(m.a,{container:!0,xs:9,justifyContent:"center",style:{height:"90%",border:"0px solid red"},children:[Object(i.jsx)(m.a,{item:!0,xs:12,style:{height:"80%",border:"solid 0px red"},children:Object(i.jsx)(x.a,{sx:{height:"98%",margin:"0 1% 0% 1%",border:"solid 0px blue"},children:Object(i.jsx)(p.a,{sx:{height:"97%"},style:{overflow:"auto",display:"flex",flexDirection:"column-reverse"},children:Object(i.jsx)(O.a,{style:{display:"flex",flexDirection:"column",border:"0px solid red"},children:a})})})}),Object(i.jsx)(m.a,{item:!0,xs:12,style:{height:"20%",border:"solid 0px red"},children:Object(i.jsxs)(O.a,{sx:{height:"95%",margin:"0 1% 0% 1%",border:"solid 0px blue",display:"flex",justifyContent:"space-between"},children:[Object(i.jsx)(f.a,{id:"input-message",disabled:""===n.activeChat,label:"Insert your message",multiline:!0,rows:4,focused:!0,style:{width:"90%"},onChange:function(e){e.target.value.trim().length<=1&&t("RENDER"),t({type:"TYPING",data:e.target.value})}}),Object(i.jsx)(C.a,{id:"send-btn",disabled:!r||!r.value.trim(),variant:"contained",style:{height:"93%"},onClick:function(){t("SENDMESSAGE"),t("CLEARINPUT")},children:"SEND"})]})})]})]})},W=function(e){var t=e.contact,n=e.action;return Object(i.jsxs)(O.a,{children:[Object(i.jsxs)(S.a,{onClick:function(){n({type:"CHANGEACTIVE",contact:t.name}),n("STARTCHAT")},alignItems:"flex-start",children:[Object(i.jsx)(R.a,{children:Object(i.jsx)(N.a,{alt:t.name,src:t.photo})}),Object(i.jsx)(T.a,{primary:t.name})]}),Object(i.jsx)(v.a,{variant:"inset",component:"li"})]})},M=function(e){var t=e.action,n=e.data;return Object(i.jsxs)(m.a,{container:!0,sx:{height:"100vh",border:"solid blue 0px"},children:[Object(i.jsx)(B,{action:t,data:n}),Object(i.jsx)(m.a,{item:!0,xs:3,style:{height:"90%",border:"0px solid red"},children:Object(i.jsx)(p.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},style:{height:"92%",overflow:"auto"},children:n.contacts.map((function(e){return Object(i.jsx)(W,{contact:e,action:t})}))})}),Object(i.jsxs)(m.a,{container:!0,xs:9,justifyContent:"center",style:{height:"90%",border:"0px solid red"},children:[Object(i.jsx)(m.a,{item:!0,xs:12,style:{height:"80%",border:"solid 0px red"},children:Object(i.jsx)(x.a,{sx:{height:"98%",margin:"0 1% 0% 1%",border:"solid 0px blue"}})}),Object(i.jsx)(m.a,{item:!0,xs:12,style:{height:"20%",border:"solid 0px red"},children:Object(i.jsxs)(O.a,{sx:{height:"95%",margin:"0 1% 0% 1%",border:"solid 0px blue",display:"flex",justifyContent:"space-between"},children:[Object(i.jsx)(f.a,{disabled:!0,label:"Insert your message",multiline:!0,rows:4,focused:!0,style:{width:"90%"}}),Object(i.jsx)(C.a,{disabled:!0,variant:"contained",style:{height:"93%"},children:"SEND"})]})})]})]})},F=n(503),V={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},Y=function(e){var t=e.action;return Object(i.jsx)(F.a,{open:!0,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(i.jsxs)(O.a,{sx:V,children:[Object(i.jsx)(E.a,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Are you sure you want to exit?"}),Object(i.jsx)(C.a,{onClick:function(){return t("YES")},children:"YES"}),Object(i.jsx)(C.a,{onClick:function(){return t("NO")},children:"NO"})]})})},J=n(522),Q=n(525),q=n(523),z=n(524),X=n(493),Z=function(e){e.data;var t=e.action;return Object(i.jsx)("div",{children:Object(i.jsxs)(J.a,{open:!0,children:[Object(i.jsx)(X.a,{children:"Add contact"}),Object(i.jsxs)(q.a,{children:[Object(i.jsx)(z.a,{children:"Enter email to add"}),Object(i.jsx)(f.a,{autoFocus:!0,margin:"dense",id:"name",label:"Email Address",type:"email",fullWidth:!0,variant:"standard",onChange:function(e){return t({type:"TYPING",data:e.target.value})}})]}),Object(i.jsxs)(Q.a,{children:[Object(i.jsx)(C.a,{onClick:function(){return t("SUBMIT")},children:"Search"}),Object(i.jsx)(C.a,{onClick:function(){return t("CANCEL")},children:"Cancel"})]})]})})},$=n(526),ee=n(506),te=n(496),ne=n(501),ae=n(498),re=n(497),ce=n(502),oe=n(156),ie=n.n(oe),se=n(424),de=n(494),le=n(495);function ue(){return Object(i.jsx)(se.a,{variant:"body2",color:"textSecondary",align:"center",children:"Developed by asltyn@rambler.ru"})}var be=Object(de.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),je=function(e){var t=e.action,n=e.data,a=be(),r=document.getElementById("name");r&&(r.value=n.name);var c=document.getElementById("password");return c&&(c.value=n.password),Object(i.jsxs)(le.a,{component:"main",maxWidth:"xs",children:[Object(i.jsx)(te.a,{}),Object(i.jsxs)("div",{className:a.paper,children:[Object(i.jsx)($.a,{className:a.avatar,children:Object(i.jsx)(ie.a,{})}),Object(i.jsx)(se.a,{component:"h1",variant:"h5",children:"chat"}),Object(i.jsxs)("form",{className:a.form,noValidate:!0,children:[Object(i.jsx)(ne.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Name",name:"name",autoComplete:"name",onChange:function(e){return t({type:"FILLNAME",data:e.target.value})}}),Object(i.jsx)(ne.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(e){return t({type:"FILLPASSWORD",data:e.target.value})},autoComplete:"current-password"}),Object(i.jsx)(ee.a,{disabled:!n.filled,fullWidth:!0,variant:"contained",color:"primary",className:a.submit,onClick:function(){t({type:"SIGNIN_CLICK"})},children:"Sign In"}),Object(i.jsxs)(re.a,{container:!0,children:[Object(i.jsx)(re.a,{item:!0,xs:!0,children:Object(i.jsx)(ae.a,{href:"#",variant:"body2",onClick:function(){return t("RECOVERY_CLICK")},children:"Forgot password?"})}),Object(i.jsx)(re.a,{item:!0,children:Object(i.jsx)(ae.a,{href:"#",variant:"body2",onClick:function(){return t("SIGNUP_CLICK")},children:"Don't have an account? Sign Up"})})]})]})]}),Object(i.jsx)(ce.a,{mt:8,children:Object(i.jsx)(ue,{})})]})};function he(){return Object(i.jsx)(se.a,{variant:"body2",color:"textSecondary",align:"center",children:"Developed by asltyn@rambler.ru"})}var Oe=Object(de.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),pe=function(e){var t=e.action,n=e.data,a=Oe(),r=document.getElementById("name");r&&(r.value=n.name);var c=document.getElementById("password");return c&&(c.value=n.password),Object(i.jsxs)(le.a,{component:"main",maxWidth:"xs",children:[Object(i.jsx)(te.a,{}),Object(i.jsxs)("div",{className:a.paper,children:[Object(i.jsx)($.a,{className:a.avatar,children:Object(i.jsx)(ie.a,{})}),Object(i.jsx)(se.a,{component:"h1",variant:"h5",children:"Registration form"}),Object(i.jsxs)("form",{className:a.form,noValidate:!0,children:[Object(i.jsx)(ne.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"name",label:"Name",name:"name",autoComplete:"name",onChange:function(e){return t({type:"FILLNAME",data:e.target.value})}}),Object(i.jsx)(ne.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(e){return t({type:"FILLPASSWORD",data:e.target.value})},autoComplete:"current-password"}),Object(i.jsx)(ee.a,{disabled:!n.filled,fullWidth:!0,variant:"contained",color:"primary",className:a.submit,onClick:function(){return t("SUBMIT_CLICK")},children:"Submit"}),Object(i.jsx)(ee.a,{fullWidth:!0,variant:"contained",color:"primary",className:a.submit,onClick:function(){return t("CANCEL_CLICK")},children:"Cancel"})]})]}),Object(i.jsx)(ce.a,{mt:8,children:Object(i.jsx)(he,{})})]})},me=n(505),xe=function(e){var t=e.action;e.data;return Object(i.jsx)(me.a,{open:!0,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(i.jsxs)(ce.a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},children:[Object(i.jsx)(se.a,{id:"modal-modal-description",sx:{mt:2},children:"Username or password is incorrect"}),Object(i.jsx)(ee.a,{onClick:function(){return t("OK")},children:"OK"})]})})},fe=function(e){var t=e.action,n=e.data;return Object(i.jsx)(me.a,{open:!0,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(i.jsxs)(ce.a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},children:[Object(i.jsx)(se.a,{id:"modal-modal-description",sx:{mt:2},children:n.answer}),Object(i.jsx)(ee.a,{onClick:function(){return t("OK")},children:"OK"})]})})},Ce=function(e){var t=e.action;return Object(i.jsxs)(J.a,{open:!0,children:[Object(i.jsx)(X.a,{children:"Contact added"}),Object(i.jsx)(q.a,{children:Object(i.jsx)(z.a,{children:" "})}),Object(i.jsx)(Q.a,{children:Object(i.jsx)(C.a,{onClick:function(){t("OK")},children:"OK"})})]})},ge=function(e){var t=e.action;return Object(i.jsxs)(J.a,{open:!0,children:[Object(i.jsx)(X.a,{children:"Can't add contact"}),Object(i.jsx)(q.a,{children:Object(i.jsx)(z.a,{children:" "})}),Object(i.jsxs)(Q.a,{children:[Object(i.jsx)(C.a,{onClick:function(){return t("OK")},children:"OK"}),Object(i.jsx)(C.a,{onClick:function(){return t("TRYAGAIN")},children:"Try again"})]})]})},ye=n(527),Ee=function(){return Object(i.jsxs)(J.a,{open:!0,children:[Object(i.jsx)(X.a,{children:"Add contact"}),Object(i.jsx)(q.a,{children:Object(i.jsx)(O.a,{sx:{display:"flex"},children:Object(i.jsx)(ye.a,{color:"inherit"})})})]})},Ae=function(e){var t=e.action,n=d.useState(null),a=Object(P.a)(n,2),r=a[0],c=a[1],o=Boolean(r);return Object(i.jsxs)("div",{children:[Object(i.jsx)(U.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},onClick:function(e){c(e.currentTarget)},children:Object(i.jsx)(L.a,{})}),Object(i.jsx)(D.a,{id:"basic-menu",anchorEl:r,open:o,onClose:function(){c(null)},MenuListProps:{"aria-labelledby":"basic-button"},children:Object(i.jsx)(G.a,{onClick:function(){return t("CANCEL")},children:"Cancel"})})]})},Se=function(e){var t=e.chatName;return Object(i.jsxs)(O.a,{children:[Object(i.jsxs)(S.a,{alignItems:"flex-start",onClick:function(){},children:[Object(i.jsx)(R.a,{children:Object(i.jsx)(N.a,{alt:t,src:"/static/images/avatar/1.jpg"})}),Object(i.jsx)(T.a,{primary:t})]}),Object(i.jsx)(v.a,{variant:"inset",component:"li"})]})},Te=function(e){var t=e.action,n=e.data,a=document.getElementById("input-message");return Object(i.jsxs)(m.a,{container:!0,sx:{height:"100vh",border:"solid blue 0px"},children:[Object(i.jsx)(m.a,{item:!0,xs:12,style:{height:"10%"},children:Object(i.jsx)(O.a,{sx:{flexGrow:1},children:Object(i.jsx)(I.a,{position:"static",children:Object(i.jsxs)(w.a,{children:[Object(i.jsx)(Ae,{action:t}),Object(i.jsx)(E.a,{variant:"h6",component:"div",sx:{flexGrow:1},children:n.myName}),Object(i.jsx)(C.a,{color:"inherit",onClick:function(){return t("LOGOUT_CLICK")},children:"logout"})]})})})}),Object(i.jsx)(m.a,{item:!0,xs:3,style:{height:"90%",border:"0px solid red"},children:Object(i.jsx)(p.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},style:{height:"92%",overflow:"auto"},children:Object(i.jsx)(Se,{chatName:"new chat with "+n.activeContact,action:t})})}),Object(i.jsxs)(m.a,{container:!0,xs:9,justifyContent:"center",style:{height:"90%",border:"0px solid red"},children:[Object(i.jsx)(m.a,{item:!0,xs:12,style:{height:"80%",border:"solid 0px red"},children:Object(i.jsx)(x.a,{sx:{height:"98%",margin:"0 1% 0% 1%",border:"solid 0px blue"},children:Object(i.jsx)(p.a,{sx:{height:"97%"},style:{overflow:"auto",display:"flex",flexDirection:"column-reverse"}})})}),Object(i.jsx)(m.a,{item:!0,xs:12,style:{height:"20%",border:"solid 0px red"},children:Object(i.jsxs)(O.a,{sx:{height:"95%",margin:"0 1% 0% 1%",border:"solid 0px blue",display:"flex",justifyContent:"space-between"},children:[Object(i.jsx)(f.a,{id:"input-message",label:"Insert your message",multiline:!0,rows:4,focused:!0,style:{width:"90%"},onChange:function(e){e.target.value.trim().length<=1&&t("RENDER"),t({type:"TYPING",data:e.target.value})}}),Object(i.jsx)(C.a,{disabled:!a||!a.value.trim(),variant:"contained",style:{height:"93%"},onClick:function(){return t("STARTNEWCHAT")},children:"SEND"})]})})]})]})},ve=n(30),Re=n(507),Ne=n(504),ke=function(e){var t=e.action,n=e.data,a=d.useState([]),r=Object(P.a)(a,2),c=r[0],o=r[1],s=d.useState(""),l=Object(P.a)(s,2),u=l[0],b=l[1],j=d.useState(!0),h=Object(P.a)(j,2),m=h[0],x=h[1];return Object(i.jsx)(F.a,{open:!0,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(i.jsxs)(O.a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,maxHeight:"50%",overflow:"auto"},children:[Object(i.jsx)(E.a,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Enter chat name"}),Object(i.jsx)(f.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,onChange:function(e){return t=e.target.value,b(t),void x(0===c.length||""===t);var t}}),Object(i.jsx)(E.a,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Choose contacts to new group chat"}),Object(i.jsx)(p.a,{dense:!0,sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},children:n.contacts.map((function(e){var t,n="".concat(e.name);return Object(i.jsx)(Re.a,{secondaryAction:Object(i.jsx)(Ne.a,{edge:"end",onChange:(t=e.name,function(){var e=c.indexOf(t),n=Object(ve.a)(c);-1===e?n.push(t):n.splice(e,1),o(n),x(0===n.length||""===u)}),checked:-1!==c.indexOf(e.name),inputProps:{"aria-labelledby":n}}),disablePadding:!0,children:Object(i.jsxs)(S.a,{children:[Object(i.jsx)(R.a,{children:Object(i.jsx)(N.a,{alt:"".concat(e.name),src:e.photo})}),Object(i.jsx)(T.a,{id:n,primary:"".concat(e.name)})]})},e.name)}))}),Object(i.jsx)(C.a,{disabled:m,onClick:function(){return t({type:"SEND",data:{checked:c,chatName:u}})},children:"CREATE"}),Object(i.jsx)(C.a,{onClick:function(){return t("CANCEL")},children:"CANCEL"})]})})},Ie=function(e){var t=e.action,n=e.data,a=l.a.useState(""),r=Object(P.a)(a,2),c=r[0],o=r[1];return Object(i.jsx)(F.a,{open:!0,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(i.jsxs)(O.a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:500,height:"50%",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,overflow:"auto"},children:[Object(i.jsx)(O.a,{sx:{height:"80%",border:"dashed 1px blue"},children:Object(i.jsx)("img",{alt:"",src:n.photo||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D",id:"prev",style:{height:"100%",width:"100%"}})}),Object(i.jsx)(E.a,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Upload photo from your local disc"}),Object(i.jsxs)("label",{htmlFor:"upload-photo",children:[Object(i.jsx)("input",{onChange:function(){return function(){var e=document.getElementById("prev"),t=document.getElementById("upload-photo").files[0],n=new FileReader;n.addEventListener("load",(function(){e.src=n.result,o(n.result)}),!1),t&&n.readAsDataURL(t)}()},style:{display:"none"},id:"upload-photo",name:"upload-photo",type:"file"}),Object(i.jsx)(C.a,{component:"span",children:"Choose photo"})]}),Object(i.jsx)(C.a,{disabled:""===c,onClick:function(){return t({type:"UPDATEPHOTO",photo:c})},children:"Update photo"}),Object(i.jsx)(C.a,{disabled:""===n.photo,onClick:function(){return t({type:"DELETEPHOTO",photo:c})},children:"Delete photo"}),Object(i.jsx)(C.a,{onClick:function(){return t("CANCEL")},children:"CANCEL"})]})})},we=function(){return Object(i.jsx)(F.a,{open:!0,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(i.jsxs)(O.a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,maxHeight:"50%",overflow:"auto"},children:[Object(i.jsx)(E.a,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Waiting for server"}),Object(i.jsx)(ye.a,{color:"inherit"})]})})},Pe=function(){return Object(i.jsx)(J.a,{open:!0,children:Object(i.jsx)(q.a,{children:Object(i.jsx)(O.a,{sx:{display:"flex"},children:Object(i.jsx)(ye.a,{color:"inherit"})})})})},De=n(19),Ge=n.n(De),Ue=function(e,t){t((function(t){switch(Ge.a.render(null,document.getElementById("modal")),t.type){case"SIGNIN":Ge.a.render(Object(i.jsx)(je,{action:e,data:t}),document.getElementById("root")),Ge.a.render("",document.getElementById("modal"));break;case"SIGNIN_REQUEST":Ge.a.render(Object(i.jsx)(j,{action:e,data:t}),document.getElementById("modal"));break;case"SIGNINERROR":Ge.a.render(Object(i.jsx)(xe,{action:e,data:t}),document.getElementById("modal"));break;case"SERVERERROR":Ge.a.render(Object(i.jsx)(s,{action:e,data:t}),document.getElementById("root")),Ge.a.render("",document.getElementById("modal"));break;case"SIGNUP":Ge.a.render(Object(i.jsx)(pe,{action:e,data:t}),document.getElementById("root")),Ge.a.render("",document.getElementById("modal"));break;case"SIGNUP_REQUEST":Ge.a.render(Object(i.jsx)(j,{action:e,data:t}),document.getElementById("modal"));break;case"SIGNUPERROR":Ge.a.render(Object(i.jsx)(fe,{action:e,data:t}),document.getElementById("modal"));break;case"START_CHAT":Ge.a.render(Object(i.jsx)(h,{action:e,data:t}),document.getElementById("root"));break;case"CHATS":Ge.a.render(Object(i.jsx)(K,{action:e,data:t}),document.getElementById("root")),Ge.a.render("",document.getElementById("modal"));break;case"CONTACTS":Ge.a.render(Object(i.jsx)(M,{action:e,data:t}),document.getElementById("root"));break;case"LOGOUT":Ge.a.render(Object(i.jsx)(Y,{action:e,data:t}),document.getElementById("modal"));break;case"ADD_CONTACT":Ge.a.render(Object(i.jsx)(Z,{action:e,data:t}),document.getElementById("modal"));break;case"ADD_CONTACT_WAIT":Ge.a.render(Object(i.jsx)(Ee,{action:e,data:t}),document.getElementById("modal"));break;case"ADD_CONTACT_SUCCESS":Ge.a.render(Object(i.jsx)(Ce,{action:e,data:t}),document.getElementById("modal"));break;case"ADD_CONTACT_ERROR":Ge.a.render(Object(i.jsx)(ge,{action:e,data:t}),document.getElementById("modal"));break;case"NEW_CHAT":Ge.a.render(Object(i.jsx)(Te,{action:e,data:t}),document.getElementById("root"));break;case"CREATE_GROUP_CHAT":Ge.a.render(Object(i.jsx)(ke,{action:e,data:t}),document.getElementById("modal"));break;case"CREATE_GROUP_CHAT_WAIT":Ge.a.render(Object(i.jsx)(we,{action:e,data:t}),document.getElementById("modal"));break;case"UPLOAD_PHOTO":Ge.a.render(Object(i.jsx)(Ie,{action:e,data:t}),document.getElementById("modal"));break;case"SERVER_WAIT":Ge.a.render(Object(i.jsx)(Pe,{}),document.getElementById("modal"));break;default:console.log("unknown state: ",t.type)}}))},He=n(28),Le=n.n(He),_e=n(33),Be=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,o;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.name,r=t.password,e.next=4,fetch("/SIGNIN",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:a,password:r})});case 4:return c=e.sent,e.next=7,c.json();case 7:return o=e.sent,e.abrupt("return",o.token?n({type:"SUCCESS",token:o.token,myName:o.name,key:o.subsKey}):n({type:"ERROR",answer:o}));case 11:e.prev=11,e.t0=e.catch(0),n("NETWORKERROR");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,o,i;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.name,r=t.password,c=t.publicKey,e.next=4,fetch("/SIGNUP",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({name:a,password:r,publicKey:c})});case 4:return o=e.sent,e.next=7,o.json();case 7:return i=e.sent,e.abrupt("return",i.token?n({type:"SUCCESS",token:i.token,myName:i.name,key:i.subsKey}):n({type:"ERROR",answer:i}));case 11:e.prev=11,e.t0=e.catch(0),n("NETWORKERROR");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),We=function(){var e=Object(_e.a)(Le.a.mark((function e(t){var n;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.token,fetch("/HEARTBEAT",{headers:{Accept:"application/json","Content-Type":"application/json",token:n},method:"POST"});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,i,s;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(o.a)({},t),r=a.token,c=a.addingContact,e.next=4,fetch("/ADDCONTACT",{headers:{Accept:"application/json","Content-Type":"application/json",token:r},method:"POST",body:JSON.stringify({addingContact:c})});case 4:return i=e.sent,e.next=7,i.json();case 7:return s=e.sent,e.abrupt("return",s.name?n("OK"):n("ERROR"));case 11:e.prev=11,e.t0=e.catch(0),n("NETWORKERROR");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,i,s,d;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(o.a)({},t),r=a.photo,c=a.token,i=a.myName,e.next=4,fetch("/CHANGEPHOTO",{headers:{Accept:"application/json","Content-Type":"application/json",token:c},method:"POST",body:JSON.stringify({photo:r,myName:i})});case 4:return s=e.sent,e.next=7,s.json();case 7:return d=e.sent,e.abrupt("return",n({type:"SUCCESS",photo:d.photo}));case 11:e.prev=11,e.t0=e.catch(0),n("NETWORKERROR");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,i,s,d,l;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(o.a)({},t),r=a.chats,c=a.activeChat,i=a.token,s=r.find((function(e){return e.chatId===c})).typingMessage,e.next=5,fetch("/SENDMESSAGE",{headers:{Accept:"application/json","Content-Type":"application/json",token:i},method:"POST",body:JSON.stringify({message:s,activeChat:c})});case 5:return d=e.sent,e.next=8,d.json();case 8:return l=e.sent,e.abrupt("return",n(Object(o.a)({type:"OK"},l)));case 12:e.prev=12,e.t0=e.catch(0),n("NETWORKERROR");case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),Ye=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,i;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(o.a)({},t),r=a.token,e.next=4,fetch("/UPDATE",{headers:{Accept:"application/json","Content-Type":"application/json",token:r},method:"GET"});case 4:return c=e.sent,e.next=7,c.json();case 7:return i=e.sent,e.abrupt("return",n({type:"DATARECIEVED",contacts:i.contacts,chats:i.chats,photo:i.photo}));case 11:e.prev=11,e.t0=e.catch(0),n("NETWORKERROR");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Je=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,i,s,d,l;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(o.a)({},t),r=a.message,c=a.activeContact,i=a.token,s=a.myName,e.next=4,fetch("/CREATEPRIVATECHAT",{headers:{Accept:"application/json","Content-Type":"application/json",token:i},method:"POST",body:JSON.stringify({message:r,activeContact:c,myName:s})});case 4:return d=e.sent,e.next=7,d.json();case 7:return l=e.sent,e.abrupt("return",n({type:"SUCCESS",insertedId:l.insertedId}));case 11:e.prev=11,e.t0=e.catch(0),n("NETWORKERROR");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Qe=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,i,s,d;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(o.a)({},t),r=a.groupChatData,c=a.token,i=a.myName,e.next=4,fetch("/CREATEGROUPCHAT",{headers:{Accept:"application/json","Content-Type":"application/json",token:c},method:"POST",body:JSON.stringify({groupChatData:r,myName:i})});case 4:return s=e.sent,e.next=7,s.json();case 7:return d=e.sent,e.abrupt("return",n(Object(o.a)({type:"SUCCSESS"},d)));case 11:e.prev=11,e.t0=e.catch(0),n("NETWORKERROR");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),qe=function(){var e=Object(_e.a)(Le.a.mark((function e(t,n){var a,r,c,i,s,d,l,u;return Le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(o.a)({},t),r=a.token,e.next=4,fetch("/SUBSCRIBE",{headers:{Accept:"application/json","Content-Type":"application/json",token:r},method:"POST"});case 4:c=e.sent,i=c.body.getReader();case 6:return e.next=9,i.read();case 9:s=e.sent,d=s.value,l=JSON.parse(String.fromCharCode.apply(null,d)),u=l.message,e.t0=u,e.next="subscribed"===e.t0?15:"heartbeat"===e.t0?17:"update"===e.t0?19:21;break;case 15:return n("SUBSCRIBED"),e.abrupt("break",22);case 17:return n("HEARTBEAT"),e.abrupt("break",22);case 19:return n("UPDATE"),e.abrupt("break",22);case 21:return e.abrupt("break",22);case 22:e.next=6;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(0),n("NETWORKERROR");case 29:case"end":return e.stop()}}),e,null,[[0,26]])})));return function(t,n){return e.apply(this,arguments)}}(),ze=function(e,t){t((function(t){switch(t.type){case"HEARTBEAT":We(t);break;case"SIGNIN_REQUEST":Be(t,e);break;case"SIGNUP_REQUEST":Ke(t,e);break;case"GET_DATA":Ye(t,e);break;case"ADD_CONTACT":Me(t,e);break;case"SUBSCRIBE":qe(t,e);break;case"SEND_MESSAGE":Ve(t,e);break;case"CREATE_NEW_CHAT":Je(t,e);break;case"CREATE_GROUP_CHAT":Qe(t,e);break;case"CHANGE_PHOTO":Fe(t,e);break;default:console.log("unexpected action: ",t.type)}}))},Xe=n(123),Ze=n.n(Xe),$e=Object(a.a)({id:"Login",initial:"signIn",context:{},entry:[Object(r.b)({renderServiceRef:function(){return Object(c.b)(Ue,"render")}}),Object(r.b)({networkServiceRef:function(){return Object(c.b)(ze,"network")}})],states:{signIn:{initial:"notFilled",entry:["resetName","resetPassword"],on:{SIGNUP_CLICK:"signUp",SIGNIN_CLICK:"signInRequest"},states:{notFilled:{entry:[Object(r.k)((function(e){return Object(o.a)(Object(o.a)({type:"SIGNIN"},e),{},{filled:!1})}),{to:"render"})],on:{FILLNAME:{actions:["fillName",Object(r.k)("CHANGESTATE")]},FILLPASSWORD:{actions:["fillPassword",Object(r.k)("CHANGESTATE")]},CHANGESTATE:{target:"filled",cond:function(e){var t=e.name,n=e.password;return t&&n}}}},filled:{entry:[Object(r.k)((function(e){return Object(o.a)(Object(o.a)({type:"SIGNIN"},e),{},{filled:!0})}),{to:"render"})],on:{FILLNAME:{actions:["fillName",Object(r.k)("CHANGESTATE")]},FILLPASSWORD:{actions:["fillPassword",Object(r.k)("CHANGESTATE")]},CHANGESTATE:{target:"notFilled",cond:function(e){var t=e.name,n=e.password;return!(t&&n)}}}}}},signInRequest:{entry:["generateRSAKey","getPublicKey",Object(r.k)((function(){return{type:"SIGNIN_REQUEST"}}),{to:"render"}),Object(r.k)((function(e){return Object(o.a)({type:"SIGNIN_REQUEST"},e)}),{to:"network"})],on:{SUCCESS:{target:"finish",actions:[Object(r.b)({token:function(e,t){return t.token}}),Object(r.b)({myName:function(e,t){return t.myName}}),Object(r.b)({key:function(e,t){return t.key}})]},ERROR:"signInError",NETWORKERROR:"serverError"}},signUp:{entry:["resetName","resetPassword",Object(r.k)((function(e){return Object(o.a)({type:"SIGNUP"},e)}),{to:"render"})],on:{CANCEL_CLICK:"signIn",SUBMIT_CLICK:"signUpRequest"},initial:"notFilled",states:{notFilled:{entry:[Object(r.k)((function(e){return Object(o.a)(Object(o.a)({type:"SIGNUP"},e),{},{filled:!1})}),{to:"render"})],on:{FILLNAME:{actions:["fillName",Object(r.k)("CHANGESTATE")]},FILLPASSWORD:{actions:["fillPassword",Object(r.k)("CHANGESTATE")]},CHANGESTATE:{target:"filled",cond:function(e){var t=e.name,n=e.password;return t&&n}}}},filled:{entry:[Object(r.k)((function(e){return Object(o.a)(Object(o.a)({type:"SIGNUP"},e),{},{filled:!0})}),{to:"render"})],on:{FILLNAME:{actions:["fillName",Object(r.k)("CHANGESTATE")]},FILLPASSWORD:{actions:["fillPassword",Object(r.k)("CHANGESTATE")]},CHANGESTATE:{target:"notFilled",cond:function(e){var t=e.name,n=e.password;return!(t&&n)}}}}}},signUpRequest:{entry:["generateRSAKey","getPublicKey",Object(r.k)((function(){return{type:"SIGNUP_REQUEST"}}),{to:"render"}),Object(r.k)((function(e){return Object(o.a)({type:"SIGNUP_REQUEST"},e)}),{to:"network"})],on:{SUCCESS:{target:"finish",actions:[Object(r.b)({token:function(e,t){return t.token}}),Object(r.b)({myName:function(e,t){return t.myName}}),Object(r.b)({key:function(e,t){return t.key}})]},ERROR:"signUpError",NETWORKERROR:"serverError"}},signInError:{entry:[Object(r.k)((function(){return{type:"SIGNINERROR"}}),{to:"render"})],on:{OK:"signIn"}},signUpError:{entry:Object(r.k)((function(e,t){return{type:"SIGNUPERROR",answer:t.answer}}),{to:"render"}),on:{OK:"signUp"}},finish:{entry:[Object(r.l)((function(e){return Object(o.a)({type:"FINISH"},e)}))],type:"final"},serverError:{entry:Object(r.k)((function(e){return{type:"SERVERERROR"}}),{to:"render"}),type:"final"}}},{actions:{generateRSAKey:Object(r.b)({RSAkey:function(e){return Ze.a.generateRSAKey(e.password,1024)}}),getPublicKey:Object(r.b)({publicKey:function(e){return Ze.a.publicKeyString(e.RSAkey)}}),fillName:Object(r.b)({name:function(e,t){return t.data||""}}),fillPassword:Object(r.b)({password:function(e,t){return t.data||""}}),contextlog:function(e){return console.log("actual context: ",e)},resetName:Object(r.b)({name:""}),resetPassword:Object(r.b)({password:""}),renderSignInPage:Object(r.k)((function(e){return Object(o.a)({type:"SIGNIN"},e)}),{to:"render"}),renderFinisWithError:Object(r.k)((function(e){return Object(o.a)({type:"FINISHWITHERROR"},e)}),{to:function(e){return e.renderServiceRef}})}}),et=Object(a.a)({id:"chatMachine",initial:"loading",entry:[Object(r.b)({renderServiceRef:function(){return Object(c.b)(Ue,"render")}}),Object(r.b)({networkServiceRef:function(){return Object(c.b)(ze,"network")}})],on:{UPDATE:{actions:"getData"},DATARECIEVED:{actions:["updateContacts","updateChats","updatePhoto"]},HEARTBEAT:{actions:"sendHeartBeat"}},states:{loading:{entry:["renderLoadingPage","subscribeToServerEvents"],on:{SUBSCRIBED:{actions:"getData"},DATARECIEVED:{target:"main",actions:["updateContacts","updateChats","updatePhoto"]}}},main:{initial:"choosingChat",on:{ADDCONTACT:"addContactState",CREATEGROUPCHAT:"createGroupChat",LOGOUT_CLICK:"logOut",CHANGEAVATAR:"uploadPhoto"},states:{choosingChat:{entry:["renderChat","clearActiveContact"],on:{CHANGEACTIVE:{target:"choosingChat",actions:[Object(r.b)({activeChat:function(e,t){return t.chatId}})]},SWITCHTOCONTACTS:"choosingContact",TYPING:{actions:[Object(r.b)({chats:function(e,t){return e.chats.find((function(t){return t.chatId===e.activeChat})).typingMessage=t.data,e.chats}})]},RENDER:{actions:"renderChat"},SENDMESSAGE:{actions:"sendMessage"},UPDATE:{actions:"getData"},OK:{actions:["updateContacts","updateChats","updatePhoto","renderChat"]},DATARECIEVED:{actions:["updateContacts","updateChats","updatePhoto","renderChat"]},CLEARINPUT:{actions:["clearMessage","renderChat"]}},exit:"resetMessage"},choosingContact:{entry:"renderContacts",on:{CHANGEACTIVE:{target:"choosingContact",actions:[Object(r.b)({activeContact:function(e,t){return t.contact}})]},SWITCHTOCHATS:"choosingChat",STARTCHAT:[{target:"choosingChat",actions:Object(r.b)({activeChat:function(e){return e.chats.find((function(t){return t.chatName===e.activeContact})).chatId}}),cond:function(e){return e.chats.some((function(t){return t.chatName===e.activeContact}))}},{target:"newChat"}]}},newChat:{entry:"renderNewChat",initial:"idle",states:{idle:{on:{CANCEL:"#chatMachine.main.choosingChat",TYPING:{actions:Object(r.b)({message:function(e,t){return t.data}})},RENDER:{actions:"renderNewChat"},STARTNEWCHAT:"creatingNewChat"}},creatingNewChat:{entry:["renderSerwerWait","createChat"],on:{SUCCESS:{target:"sendingMessage",actions:["updateActiveChatId"]},ERROR:"errorState"}},sendingMessage:{entry:[Object(r.b)({chats:function(e,t){return e.chats.push({chatId:e.activeChat,typingMessage:e.message,messages:[]}),e.chats}}),"sendMessage"],on:{OK:"#chatMachine.main.choosingChat",NETWORKERROR:"errorState"}},errorState:{entry:"serverError",type:"final"}},exit:["resetMessage"]},hist:{type:"history"}}},addContactState:{initial:"idle",states:{idle:{entry:["resetContact","renderAddContact"],on:{TYPING:{actions:Object(r.b)({addingContact:function(e,t){return t.data}})},CANCEL:"#chatMachine.main.choosingChat",SUBMIT:"waitingForServer"}},waitingForServer:{entry:[Object(r.k)((function(e){return Object(o.a)({type:"ADD_CONTACT_WAIT"},e)}),{to:"render"}),Object(r.k)((function(e){return Object(o.a)({type:"ADD_CONTACT"},e)}),{to:"network"})],exit:"resetContact",on:{OK:{target:"sucessState",actions:"getData"},ERROR:"errorState"}},sucessState:{entry:Object(r.k)((function(e){return Object(o.a)({type:"ADD_CONTACT_SUCCESS"},e)}),{to:"render"}),on:{OK:"#chatMachine.main.choosingContact"}},errorState:{entry:Object(r.k)((function(e){return Object(o.a)({type:"ADD_CONTACT_ERROR"},e)}),{to:"render"}),on:{OK:"#chatMachine.main.choosingChat",TRYAGAIN:"idle"}}}},uploadPhoto:{initial:"upload",states:{upload:{entry:Object(r.k)((function(e){return Object(o.a)({type:"UPLOAD_PHOTO"},e)}),{to:"render"}),on:{UPDATEPHOTO:{target:"waitingForServer"},DELETEPHOTO:{target:"waitingForServer",actions:[Object(r.b)({photo:""})]},CANCEL:"#chatMachine.main.hist"}},waitingForServer:{entry:[Object(r.k)((function(e,t){return Object(o.a)(Object(o.a)({type:"CHANGE_PHOTO"},e),{},{photo:t.photo})}),{to:"network"})],on:{SUCCESS:{target:"#chatMachine.main.hist",actions:Object(r.b)({photo:function(e,t){return t.photo}})}}},sucessState:{entry:"#chatMachine.main.choosingChat"},errorState:{entry:"serverError",type:"final"}}},logOut:{entry:["renderLogOut"],on:{YES:"exit",NO:"main.hist"}},createGroupChat:{initial:"idle",states:{idle:{entry:["renderCreateGroupChat"],on:{SEND:{target:"waitingForServer",actions:Object(r.b)({groupChatData:function(e,t){return t.data}})},CANCEL:"#chatMachine.main.hist"}},waitingForServer:{entry:[Object(r.k)((function(e){return Object(o.a)({type:"CREATE_GROUP_CHAT_WAIT"},e)}),{to:"render"}),Object(r.k)((function(e){return Object(o.a)({type:"CREATE_GROUP_CHAT"},e)}),{to:"network"})],on:{SUCCSESS:{actions:["updateContacts","updateChats","updatePhoto","updateActiveChatId"],target:"#chatMachine.main.choosingChat"}}}}},exit:{entry:[Object(r.l)((function(){return{type:"FINISH"}}))],type:"final"}}},{actions:{subscribeToServerEvents:Object(r.k)((function(e){return Object(o.a)({type:"SUBSCRIBE"},e)}),{to:"network"}),sendHeartBeat:Object(r.k)((function(e){return Object(o.a)({type:"HEARTBEAT"},e)}),{to:"network"}),contextlog:function(e){return console.log("actual context: ",e)},setContacts:Object(r.b)({contacts:!0}),setChats:Object(r.b)({chats:!0}),renderChat:Object(r.k)((function(e){return Object(o.a)({type:"CHATS"},e)}),{to:"render"}),resetContact:Object(r.b)({addingContact:""}),resetMessage:Object(r.b)({message:""}),getData:Object(r.k)((function(e){return Object(o.a)({type:"GET_DATA"},e)}),{to:"network"}),sendMessage:Object(r.k)((function(e){return Object(o.a)({type:"SEND_MESSAGE"},e)}),{to:"network"}),createChat:Object(r.k)((function(e){return Object(o.a)({type:"CREATE_NEW_CHAT"},e)}),{to:"network"}),renderLoadingPage:Object(r.k)((function(e){return Object(o.a)({type:"START_CHAT"},e)}),{to:"render"}),renderNewChat:Object(r.k)((function(e){return Object(o.a)({type:"NEW_CHAT"},e)}),{to:"render"}),renderAddContact:Object(r.k)((function(e){return Object(o.a)({type:"ADD_CONTACT"},e)}),{to:"render"}),renderCreateGroupChat:Object(r.k)((function(e){return Object(o.a)({type:"CREATE_GROUP_CHAT"},e)}),{to:"render"}),updateContacts:Object(r.b)({contacts:function(e,t){return t.contacts}}),updateChats:Object(r.b)({chats:function(e,t){return t.chats.map((function(t){var n=t.chatId,a=t.chatName,r=t.messages,c=t.photo;return{chatId:n,chatName:a,messages:r.map((function(t){var n=t.name,a=t.message;return{name:n,message:Ze.a.decrypt(a,e.RSAkey).plaintext}})),photo:c}}))}}),updatePhoto:Object(r.b)({photo:function(e,t){return t.photo}}),updateActiveChatId:Object(r.b)({activeChat:function(e,t){return t.insertedId}}),renderContacts:Object(r.k)((function(e){return Object(o.a)({type:"CONTACTS"},e)}),{to:"render"}),clearActiveContact:Object(r.b)({activeContact:function(e,t){return""}}),clearActiveChat:Object(r.b)({activeChat:function(e,t){return""}}),clearMessage:Object(r.b)({chats:function(e,t){return e.chats.find((function(t){return t.chatId===e.activeChat})).typingMessage="",e.chats}}),renderSerwerWait:Object(r.k)((function(e){return Object(o.a)({type:"SERVER_WAIT"},e)}),{to:"render"}),renderLogOut:Object(r.k)((function(e){return Object(o.a)({type:"LOGOUT"},e)}),{to:"render"}),serverError:Object(r.k)((function(){return{type:"SERVERERROR"}}),{to:"render"})}});(function(){var e=Object(a.a)({id:"app",initial:"login",context:{},states:{login:{invoke:{id:"loginMachine",src:$e},on:{FINISH:{target:"chat",actions:[Object(r.b)({token:function(e,t){return t.token}}),Object(r.b)({myName:function(e,t){return t.myName}}),Object(r.b)({RSAkey:function(e,t){return t.RSAkey}})]}}},chat:{invoke:{id:"chatMachine",src:et,data:{token:function(e){return e.token},myName:function(e){return e.myName},RSAkey:function(e){return e.RSAkey},activeChat:""}},on:{FINISH:{target:"login",actions:[Object(r.b)({token:""}),Object(r.b)({myName:""}),Object(r.b)({RSAkey:""})]}}}}});Object(c.a)(e).start()})()}},[[417,1,2]]]);
//# sourceMappingURL=main.0549fab8.chunk.js.map